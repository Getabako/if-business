<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ブログ記事 - if(Business)</title>
    <link rel="icon" type="image/png" href="images/favicon.png">
    <link rel="apple-touch-icon" href="images/favicon.png">
    <meta property="og:type" content="article">
    <meta property="og:site_name" content="if(Business)">
    <meta name="twitter:card" content="summary_large_image">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700;900&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html { scroll-behavior: smooth; }
        body {
            font-family: 'Noto Sans JP', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            color: #1a1a2e; line-height: 1.8;
            -webkit-font-smoothing: antialiased;
            background: #fafbfc;
        }

        /* Navigation */
        .navigation {
            position: fixed; top: 0; left: 0; right: 0; z-index: 1000;
            background: rgba(10, 10, 26, 0.97); backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(59, 130, 246, 0.15);
        }
        .nav-container {
            max-width: 1280px; margin: 0 auto; padding: 0.9rem 2rem;
            display: flex; justify-content: space-between; align-items: center;
        }
        .nav-logo { display: flex; align-items: center; text-decoration: none; }
        .nav-logo img { height: 36px; width: auto; }
        .nav-menu {
            position: fixed; top: 0; right: -100%; width: 300px; height: 100vh;
            background: rgba(10, 10, 26, 0.98); backdrop-filter: blur(20px);
            display: flex; flex-direction: column; padding: 80px 2rem 2rem;
            list-style: none; transition: right 0.3s ease; z-index: 999;
        }
        .nav-menu.active { right: 0; }
        .nav-menu li { margin-bottom: 0.5rem; }
        .nav-menu a {
            color: rgba(255,255,255,0.85); text-decoration: none; font-size: 0.95rem;
            padding: 0.8rem 0; display: block; border-bottom: 1px solid rgba(255,255,255,0.06);
            transition: all 0.3s ease; font-weight: 500;
        }
        .nav-menu a:hover { color: #60a5fa; padding-left: 0.75rem; }
        .mobile-menu-toggle {
            display: flex; flex-direction: column; gap: 5px; cursor: pointer;
            background: none; border: none; width: 28px; height: 28px;
            justify-content: center; align-items: center; z-index: 1001;
        }
        .mobile-menu-toggle span { width: 22px; height: 2px; background: white; transition: all 0.3s ease; transform-origin: center; border-radius: 2px; }
        .mobile-menu-toggle.active span:nth-child(1) { transform: rotate(45deg) translate(5px, 5px); }
        .mobile-menu-toggle.active span:nth-child(2) { opacity: 0; }
        .mobile-menu-toggle.active span:nth-child(3) { transform: rotate(-45deg) translate(5px, -5px); }
        .menu-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.5); z-index: 998; opacity: 0; visibility: hidden; transition: all 0.3s ease;
        }
        .menu-overlay.active { opacity: 1; visibility: visible; }

        /* Breadcrumb */
        .breadcrumb {
            max-width: 1100px; margin: 0 auto; padding: 5.5rem 2rem 0;
            font-size: 0.8rem; color: #94a3b8;
        }
        .breadcrumb a { color: #64748b; text-decoration: none; font-weight: 500; }
        .breadcrumb a:hover { color: #2563eb; }
        .breadcrumb span { margin: 0 0.4rem; color: #cbd5e1; }

        /* Layout */
        .article-layout {
            max-width: 1100px; margin: 0 auto; padding: 1.5rem 2rem 4rem;
            display: grid; grid-template-columns: 1fr 260px; gap: 3.5rem;
        }

        /* Article Header */
        .article-main { min-width: 0; }
        .article-header { margin-bottom: 2rem; padding-bottom: 2rem; border-bottom: 1px solid #eef1f6; }
        .article-category {
            display: inline-block; padding: 0.2rem 0.7rem; border-radius: 4px;
            font-size: 0.75rem; font-weight: 700; margin-bottom: 0.75rem;
            letter-spacing: 0.02em;
        }
        .article-category { background: #eff6ff; color: #2563eb; }
        .article-category.cat-programming { background: #fefce8; color: #ca8a04; }
        .article-category.cat-report { background: #ecfdf5; color: #059669; }
        .article-title {
            font-size: clamp(1.5rem, 3.5vw, 2rem); font-weight: 900;
            line-height: 1.5; color: #0f172a; margin-bottom: 0.75rem;
            letter-spacing: -0.01em;
        }
        .article-meta { display: flex; gap: 1rem; align-items: center; color: #94a3b8; font-size: 0.8rem; }
        .article-meta i { margin-right: 0.2rem; }

        /* Article Content — Rich Typography */
        .article-content {
            font-size: 1rem; line-height: 2; color: #374151;
        }

        /* Introduction */
        .article-introduction {
            font-size: 1.05rem; line-height: 2; color: #4b5563;
            padding: 1.5rem; margin-bottom: 2.5rem;
            background: #f8f9fb; border-radius: 8px; border-left: 3px solid #2563eb;
        }

        /* Sections */
        .article-section { margin-bottom: 3rem; }
        .article-section h2 {
            font-size: 1.3rem; font-weight: 800; color: #0f172a;
            margin-bottom: 1.25rem; padding-bottom: 0.5rem;
            border-bottom: 2px solid #0f172a; display: inline-block;
        }
        .article-section h3 {
            font-size: 1.1rem; font-weight: 700; color: #1e293b;
            margin: 1.5rem 0 0.75rem; padding-left: 0.75rem;
            border-left: 3px solid #2563eb;
        }
        .article-section p {
            font-size: 1rem; line-height: 2; color: #374151; margin-bottom: 1rem;
        }
        .article-section ul, .article-section ol {
            margin: 1rem 0 1.5rem 1.5rem; color: #374151;
        }
        .article-section li {
            margin-bottom: 0.5rem; line-height: 1.9; font-size: 0.95rem;
        }
        .article-section strong { color: #0f172a; font-weight: 700; }
        .article-section blockquote {
            margin: 1.5rem 0; padding: 1rem 1.5rem;
            background: #f8f9fb; border-left: 3px solid #94a3b8;
            border-radius: 0 8px 8px 0; color: #64748b;
            font-style: italic; font-size: 0.95rem; line-height: 1.9;
        }
        .article-section table {
            width: 100%; margin: 1rem 0 1.5rem; border-collapse: collapse;
            font-size: 0.9rem;
        }
        .article-section th {
            background: #f1f5f9; padding: 0.6rem 1rem; text-align: left;
            font-weight: 700; color: #334155; border-bottom: 2px solid #e2e8f0;
        }
        .article-section td {
            padding: 0.5rem 1rem; border-bottom: 1px solid #f1f5f9; color: #475569;
        }
        .article-section code {
            background: #f1f5f9; padding: 0.15rem 0.4rem; border-radius: 4px;
            font-size: 0.88em; color: #e11d48; font-family: 'SF Mono', 'Fira Code', monospace;
        }
        .article-section pre {
            background: #1e293b; color: #e2e8f0; padding: 1.25rem 1.5rem;
            border-radius: 8px; overflow-x: auto; margin: 1rem 0 1.5rem;
            font-size: 0.85rem; line-height: 1.7;
            font-family: 'SF Mono', 'Fira Code', monospace;
        }
        .article-section pre code {
            background: none; color: inherit; padding: 0; font-size: inherit;
        }

        /* Key Points */
        .key-points {
            background: white; border: 1px solid #e5e9f0; border-radius: 8px;
            padding: 1.25rem 1.5rem; margin-top: 1.25rem;
        }
        .key-points h4 {
            font-size: 0.8rem; font-weight: 700; color: #2563eb;
            text-transform: uppercase; letter-spacing: 0.08em; margin-bottom: 0.6rem;
        }
        .key-points ul { list-style: none; margin: 0; padding: 0; }
        .key-points li {
            padding: 0.35rem 0 0.35rem 1.4rem; font-size: 0.9rem; color: #475569;
            position: relative; margin: 0; line-height: 1.7;
        }
        .key-points li::before {
            content: ''; position: absolute; left: 0; top: 0.7rem;
            width: 6px; height: 6px; background: #2563eb; border-radius: 50%;
        }

        /* Conclusion */
        .article-conclusion {
            background: #f8f9fb; border-radius: 8px;
            padding: 2rem; margin-top: 2rem; border: 1px solid #e5e9f0;
        }
        .article-conclusion h2 {
            font-size: 1.15rem; font-weight: 800; color: #0f172a; margin-bottom: 1rem;
            border-bottom: none; display: block; padding-bottom: 0;
        }
        .article-conclusion p { font-size: 1rem; line-height: 2; color: #374151; }

        /* Share */
        .share-section {
            margin-top: 2.5rem; padding-top: 2rem; border-top: 1px solid #eef1f6;
            display: flex; align-items: center; gap: 1rem;
        }
        .share-label { font-size: 0.8rem; color: #94a3b8; font-weight: 600; white-space: nowrap; }
        .share-buttons { display: flex; gap: 0.5rem; }
        .share-btn {
            width: 38px; height: 38px; border-radius: 8px; border: 1px solid #e5e9f0;
            background: white; color: #64748b; font-size: 0.95rem; cursor: pointer;
            transition: all 0.2s ease; display: flex; align-items: center; justify-content: center;
        }
        .share-btn:hover { border-color: transparent; color: white; }
        .share-btn.twitter:hover { background: #1da1f2; }
        .share-btn.facebook:hover { background: #1877f2; }
        .share-btn.line-share:hover { background: #06c755; }
        .share-btn.copy-link:hover { background: #6366f1; }

        /* Bottom CTA */
        .bottom-cta {
            background: #0f172a; border-radius: 12px;
            padding: 2.5rem; text-align: center; color: white; margin-top: 2.5rem;
        }
        .bottom-cta h3 { font-size: 1.2rem; font-weight: 800; margin-bottom: 0.5rem; }
        .bottom-cta p { color: rgba(255,255,255,0.6); margin-bottom: 1.25rem; font-size: 0.9rem; line-height: 1.8; }
        .bottom-cta-btn {
            display: inline-block; padding: 0.8rem 2rem;
            background: #2563eb; color: white;
            text-decoration: none; border-radius: 8px; font-weight: 700;
            font-size: 0.95rem; transition: all 0.2s ease;
        }
        .bottom-cta-btn:hover { background: #1d4ed8; transform: translateY(-1px); }

        /* Sidebar */
        .sidebar { position: relative; }
        .sidebar-inner { position: sticky; top: 5rem; display: flex; flex-direction: column; gap: 1.5rem; }

        /* TOC */
        .toc-card {
            background: white; border-radius: 10px; padding: 1.25rem;
            border: 1px solid #eef1f6;
        }
        .toc-card h3 {
            font-size: 0.75rem; font-weight: 700; color: #94a3b8;
            text-transform: uppercase; letter-spacing: 0.1em;
            margin-bottom: 0.75rem; padding-bottom: 0.5rem;
            border-bottom: 1px solid #f1f5f9;
        }
        .toc-list { list-style: none; }
        .toc-list li { margin-bottom: 0.25rem; }
        .toc-list a {
            display: block; padding: 0.35rem 0.5rem; font-size: 0.8rem;
            color: #64748b; text-decoration: none; border-radius: 4px;
            transition: all 0.15s ease; line-height: 1.5; font-weight: 500;
        }
        .toc-list a:hover { color: #2563eb; background: #f0f7ff; }
        .toc-list a.active { color: #2563eb; background: #eff6ff; font-weight: 700; }

        /* Sidebar Related */
        .sidebar-card {
            background: white; border-radius: 10px; padding: 1.25rem;
            border: 1px solid #eef1f6;
        }
        .sidebar-card h3 {
            font-size: 0.75rem; font-weight: 700; color: #94a3b8;
            text-transform: uppercase; letter-spacing: 0.1em;
            margin-bottom: 0.75rem; padding-bottom: 0.5rem;
            border-bottom: 1px solid #f1f5f9;
        }
        .sidebar-post {
            display: block; text-decoration: none; color: inherit;
            padding: 0.5rem 0; transition: all 0.15s ease;
        }
        .sidebar-post + .sidebar-post { border-top: 1px solid #f8f9fb; }
        .sidebar-post:hover .sidebar-post-title { color: #2563eb; }
        .sidebar-post-title { font-size: 0.82rem; font-weight: 600; color: #475569; line-height: 1.6; }
        .sidebar-post-date { font-size: 0.72rem; color: #94a3b8; margin-top: 0.15rem; }

        .sidebar-cta {
            background: #0f172a; border-radius: 10px;
            padding: 1.5rem; text-align: center; color: white;
        }
        .sidebar-cta h3 { color: white; font-size: 0.9rem; font-weight: 800; margin-bottom: 0.5rem; border: none; padding: 0; text-transform: none; letter-spacing: 0; }
        .sidebar-cta p { font-size: 0.8rem; color: rgba(255,255,255,0.6); margin-bottom: 1rem; line-height: 1.7; }
        .sidebar-cta-btn {
            display: inline-block; padding: 0.5rem 1.5rem; background: #2563eb;
            color: white; text-decoration: none; border-radius: 6px;
            font-weight: 700; font-size: 0.8rem; transition: all 0.2s ease;
        }
        .sidebar-cta-btn:hover { background: #1d4ed8; }

        /* Footer */
        .site-footer {
            background: #0a0f1b; color: white; padding: 2.5rem 2rem 1.5rem;
            border-top: 1px solid rgba(59, 130, 246, 0.1); margin-top: 0;
        }
        .footer-content {
            max-width: 1100px; margin: 0 auto; display: flex; flex-wrap: wrap;
            justify-content: space-between; align-items: center; gap: 1.5rem;
        }
        .footer-logo { display: flex; align-items: center; gap: 0.75rem; }
        .footer-logo img { height: 32px; width: auto; opacity: 0.8; }
        .footer-logo-text { font-size: 1rem; font-weight: 700; color: rgba(255,255,255,0.8); }
        .footer-links { display: flex; gap: 1.5rem; flex-wrap: wrap; }
        .footer-links a { color: rgba(255,255,255,0.5); text-decoration: none; font-size: 0.8rem; transition: color 0.2s; }
        .footer-links a:hover { color: rgba(255,255,255,0.9); }
        .footer-bottom { max-width: 1100px; margin: 1.5rem auto 0; padding-top: 1rem; border-top: 1px solid rgba(255,255,255,0.06); text-align: center; }
        .footer-bottom p { color: rgba(255,255,255,0.3); font-size: 0.75rem; }

        /* Loading */
        .loading { text-align: center; padding: 6rem 2rem; color: #94a3b8; }
        .loading-spinner { width: 28px; height: 28px; border: 3px solid #e5e9f0; border-top-color: #2563eb; border-radius: 50%; animation: spin 0.8s linear infinite; margin: 0 auto 1rem; }
        @keyframes spin { to { transform: rotate(360deg); } }

        @media (max-width: 900px) {
            .article-layout { grid-template-columns: 1fr; gap: 2rem; }
            .sidebar { order: -1; }
            .sidebar-inner { position: static; }
            .toc-card { display: none; }
        }
        @media (max-width: 768px) {
            .article-layout { padding: 1rem 1rem 3rem; }
            .breadcrumb { padding: 5rem 1rem 0; }
            .article-title { font-size: 1.4rem; }
            .article-introduction { padding: 1.25rem; font-size: 0.95rem; }
            .article-section h2 { font-size: 1.15rem; }
            .bottom-cta { padding: 2rem 1.5rem; }
            .share-section { flex-direction: column; align-items: flex-start; }
            .footer-content { flex-direction: column; align-items: center; text-align: center; }
            .footer-links { justify-content: center; }
        }
    </style>
</head>
<body>
    <nav class="navigation">
        <div class="nav-container">
            <a href="index.html" class="nav-logo">
                <img src="images/-1.png" alt="if(Business) Logo">
            </a>
            <button class="mobile-menu-toggle" id="mobileMenuToggle">
                <span></span><span></span><span></span>
            </button>
        </div>
        <div class="menu-overlay" id="menuOverlay"></div>
        <ul class="nav-menu" id="navMenu">
            <li><a href="index.html">トップページ</a></li>
            <li><a href="blog.html" style="color: #60a5fa;">ブログ</a></li>
            <li><a href="index.html#ai-diagnosis">AIプラン診断</a></li>
            <li><a href="index.html#ai-system-dev">AIシステム開発</a></li>
            <li><a href="index.html#ai-advisor">AIパーソナル顧問</a></li>
            <li><a href="index.html#ai-training">AI人材育成</a></li>
            <li><a href="index.html#courses">AI講座</a></li>
            <li><a href="index.html#company">会社情報</a></li>
            <li><a href="https://lin.ee/I4dbdzC" target="_blank" style="color: #06C755 !important;"><i class="fab fa-line"></i> LINE友だち登録</a></li>
        </ul>
    </nav>

    <div class="breadcrumb">
        <a href="index.html">ホーム</a><span>›</span>
        <a href="blog.html">ブログ</a><span>›</span>
        <span id="breadcrumbTitle">記事</span>
    </div>

    <div class="article-layout" id="articleLayout" style="display:none;">
        <article class="article-main">
            <div class="article-header">
                <span class="article-category" id="articleCategory"></span>
                <h1 class="article-title" id="articleTitle"></h1>
                <div class="article-meta">
                    <span id="articleDate"></span>
                    <span id="articleAuthor"></span>
                </div>
            </div>
            <div class="article-content" id="articleContent"></div>

            <div class="share-section">
                <span class="share-label">SHARE</span>
                <div class="share-buttons">
                    <button class="share-btn twitter" onclick="shareTwitter()" title="X(Twitter)"><i class="fab fa-x-twitter"></i></button>
                    <button class="share-btn facebook" onclick="shareFacebook()" title="Facebook"><i class="fab fa-facebook-f"></i></button>
                    <button class="share-btn line-share" onclick="shareLine()" title="LINE"><i class="fab fa-line"></i></button>
                    <button class="share-btn copy-link" onclick="copyLink()" title="リンクをコピー"><i class="fas fa-link"></i></button>
                </div>
            </div>

            <div class="bottom-cta">
                <h3>AIについてもっと知りたい方は</h3>
                <p>AIの導入方法や活用事例について、専門スタッフが無料でご相談に応じます。</p>
                <a href="https://forms.gle/JQVBdZdrUWGysvhaA" target="_blank" class="bottom-cta-btn">
                    無料相談はこちら →
                </a>
            </div>
        </article>

        <aside class="sidebar">
            <div class="sidebar-inner">
                <div class="toc-card" id="tocCard" style="display:none;">
                    <h3>目次</h3>
                    <ul class="toc-list" id="tocList"></ul>
                </div>
                <div class="sidebar-cta">
                    <h3>無料相談受付中</h3>
                    <p>AI導入・業務改善について<br>お気軽にご相談ください</p>
                    <a href="https://forms.gle/JQVBdZdrUWGysvhaA" target="_blank" class="sidebar-cta-btn">相談する</a>
                </div>
                <div class="sidebar-card">
                    <h3>最新の記事</h3>
                    <div id="relatedPosts"></div>
                </div>
            </div>
        </aside>
    </div>

    <div class="loading" id="loadingState">
        <div class="loading-spinner"></div>
        <p>記事を読み込み中...</p>
    </div>

    <footer class="site-footer">
        <div class="footer-content">
            <div class="footer-logo">
                <img src="images/-1.png" alt="if(Business)">
                <span class="footer-logo-text">if(Business)</span>
            </div>
            <div class="footer-links">
                <a href="index.html">トップページ</a>
                <a href="blog.html">ブログ</a>
                <a href="privacy.html">プライバシー</a>
                <a href="terms.html">利用規約</a>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2024 if(Business) - if(塾). All Rights Reserved.</p>
        </div>
    </footer>

    <script>
        // Mobile menu
        const toggle = document.getElementById('mobileMenuToggle');
        const navMenu = document.getElementById('navMenu');
        const overlay = document.getElementById('menuOverlay');
        toggle.addEventListener('click', () => {
            toggle.classList.toggle('active'); navMenu.classList.toggle('active'); overlay.classList.toggle('active');
        });
        overlay.addEventListener('click', () => {
            toggle.classList.remove('active'); navMenu.classList.remove('active'); overlay.classList.remove('active');
        });

        const categoryClassMap = { 'プログラミング': 'cat-programming', '活動報告': 'cat-report' };
        const slug = new URLSearchParams(window.location.search).get('slug');

        async function loadArticle() {
            if (!slug) { window.location.href = 'blog.html'; return; }
            try {
                const res = await fetch(`blog/posts/${slug}.json`);
                if (!res.ok) throw new Error('Not found');
                const post = await res.json();

                // OGP
                document.title = `${post.title} - if(Business)`;
                setMeta('og:title', post.title);
                setMeta('og:description', post.introduction);
                setMeta('og:url', location.href);
                setMeta('twitter:title', post.title);
                setMeta('twitter:description', post.introduction);

                document.getElementById('breadcrumbTitle').textContent = post.title;
                document.getElementById('articleTitle').textContent = post.title;

                const catEl = document.getElementById('articleCategory');
                const cat = post.category || post.metadata?.category || '';
                catEl.textContent = cat;
                if (categoryClassMap[cat]) catEl.classList.add(categoryClassMap[cat]);

                const date = new Date(post.date);
                document.getElementById('articleDate').innerHTML =
                    `<i class="far fa-calendar-alt"></i> ${date.getFullYear()}年${date.getMonth()+1}月${date.getDate()}日`;

                if (post.author) {
                    document.getElementById('articleAuthor').innerHTML =
                        `<i class="far fa-user"></i> ${post.author}`;
                }

                // Build article HTML
                let html = `<div class="article-introduction">${post.introduction}</div>`;
                const tocItems = [];

                post.sections.forEach((s, i) => {
                    const sectionId = `section-${i}`;
                    tocItems.push({ id: sectionId, title: s.heading });
                    html += `<div class="article-section" id="${sectionId}">`;
                    html += `<h2>${s.heading}</h2>`;

                    // Use contentHtml if available, otherwise plain content
                    if (s.contentHtml) {
                        html += s.contentHtml;
                    } else {
                        html += `<p>${s.content}</p>`;
                    }

                    if (s.keyPoints?.length) {
                        html += `<div class="key-points"><h4>ポイント</h4><ul>`;
                        s.keyPoints.forEach(k => html += `<li>${k}</li>`);
                        html += `</ul></div>`;
                    }
                    html += `</div>`;
                });

                // Conclusion
                const conclusionId = 'section-conclusion';
                tocItems.push({ id: conclusionId, title: 'まとめ' });
                html += `<div class="article-conclusion" id="${conclusionId}"><h2>まとめ</h2><p>${post.conclusion}</p></div>`;

                document.getElementById('articleContent').innerHTML = html;

                // TOC
                if (tocItems.length > 1) {
                    const tocCard = document.getElementById('tocCard');
                    const tocList = document.getElementById('tocList');
                    tocCard.style.display = 'block';
                    tocList.innerHTML = tocItems.map(t =>
                        `<li><a href="#${t.id}" data-target="${t.id}">${t.title}</a></li>`
                    ).join('');

                    // TOC active state on scroll
                    const sectionEls = tocItems.map(t => document.getElementById(t.id));
                    const tocLinks = tocList.querySelectorAll('a');
                    window.addEventListener('scroll', () => {
                        let current = 0;
                        sectionEls.forEach((el, i) => {
                            if (el && el.getBoundingClientRect().top < 120) current = i;
                        });
                        tocLinks.forEach((a, i) => {
                            a.classList.toggle('active', i === current);
                        });
                    }, { passive: true });
                }

                document.getElementById('loadingState').style.display = 'none';
                document.getElementById('articleLayout').style.display = 'grid';
                loadRelatedPosts();
            } catch (e) {
                document.getElementById('loadingState').innerHTML =
                    '<p style="color:#64748b;">記事が見つかりませんでした。<br><a href="blog.html" style="color:#2563eb;">ブログ一覧に戻る</a></p>';
            }
        }

        function setMeta(prop, content) {
            let el = document.querySelector(`meta[property="${prop}"], meta[name="${prop}"]`);
            if (!el) { el = document.createElement('meta'); el.setAttribute(prop.startsWith('og:') ? 'property' : 'name', prop); document.head.appendChild(el); }
            el.setAttribute('content', content);
        }

        async function loadRelatedPosts() {
            try {
                const res = await fetch('blog/posts/index.json');
                const data = await res.json();
                const others = data.posts.filter(p => p.slug !== slug).slice(0, 4);
                document.getElementById('relatedPosts').innerHTML = others.map(p => {
                    const d = new Date(p.date);
                    return `<a href="blog-post.html?slug=${p.slug}" class="sidebar-post">
                        <div class="sidebar-post-title">${p.title}</div>
                        <div class="sidebar-post-date">${d.getFullYear()}/${d.getMonth()+1}/${d.getDate()}</div>
                    </a>`;
                }).join('');
            } catch (e) {}
        }

        function shareTwitter() {
            window.open(`https://twitter.com/intent/tweet?url=${encodeURIComponent(location.href)}&text=${encodeURIComponent(document.getElementById('articleTitle').textContent)}`, '_blank');
        }
        function shareFacebook() {
            window.open(`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(location.href)}`, '_blank');
        }
        function shareLine() {
            window.open(`https://social-plugins.line.me/lineit/share?url=${encodeURIComponent(location.href)}`, '_blank');
        }
        function copyLink() {
            navigator.clipboard.writeText(location.href).then(() => {
                const btn = document.querySelector('.copy-link');
                btn.innerHTML = '<i class="fas fa-check"></i>';
                setTimeout(() => btn.innerHTML = '<i class="fas fa-link"></i>', 2000);
            });
        }

        loadArticle();
    </script>
</body>
</html>
