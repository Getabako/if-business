# Claude Code 開発ルール

## サブエージェント活用ベストプラクティス

### 1. 並列処理の原則

**必須**: 独立したタスクは必ず並列実行すること

```
✅ Good: 1つのメッセージで複数のTaskツールを呼び出す
❌ Bad: タスクを順次実行する（依存関係がない場合）
```

**並列実行の例**:
- コードベース探索 + テスト実行
- 複数ファイルの実装タスク
- コードレビュー + ビルド実行

### 2. エージェント選択ガイドライン

#### Exploreエージェント（コードベース探索特化）
**用途**:
- コードベース構造の理解
- 特定パターンのファイル検索（例: `src/**/*.tsx`）
- キーワードでのコード検索
- アーキテクチャ理解のための広範な探索

**徹底性レベル**:
- `quick`: 基本的な検索
- `medium`: 中程度の探索
- `very thorough`: 包括的な分析

**使用例**:
```
「エラーハンドリングの実装場所を調査」
「API エンドポイントの仕組みを理解」
「コンポーネント構造の把握」
```

#### general-purposeエージェント
**用途**:
- 複雑なマルチステップタスク
- コード実装と修正
- 包括的なリファクタリング
- テストの作成と実行

### 3. Definition of Done (DOD)

**各フェーズ終了時に必ず実施**:

#### ✓ コードレビュー
- 実装の品質確認
- ベストプラクティス遵守
- セキュリティチェック
- パフォーマンス確認

#### ✓ プロダクションビルド
```bash
npm run build
# または
yarn build
```

#### ✓ テスト実行
```bash
npm test
# または
yarn test
```

#### ✓ 型チェック（TypeScript の場合）
```bash
npm run type-check
# または
tsc --noEmit
```

### 4. 効率的なワークフロー

#### フェーズ1: 探索・分析
```
並列実行:
- Exploreエージェント（コードベース理解）
- Exploreエージェント（関連ファイル検索）
```

#### フェーズ2: 実装
```
並列実行:
- general-purposeエージェント（機能A実装）
- general-purposeエージェント（機能B実装）
```

#### フェーズ3: DOD実施
```
並列実行:
- general-purposeエージェント（コードレビュー）
- Bashツール（ビルド + テスト）
```

### 5. 実行コマンド例

#### 並列エージェント起動（1メッセージで複数Task）
```
Task 1: Explore - "medium" - コンポーネント構造の分析
Task 2: Explore - "quick" - API実装の検索
Task 3: general-purpose - テストカバレッジの確認
```

#### DOD実行
```bash
# ビルド
npm run build && echo "✓ Build Success"

# テスト
npm test && echo "✓ Tests Passed"

# 型チェック
npm run type-check && echo "✓ Type Check Passed"
```

### 6. 禁止事項

❌ **してはいけないこと**:
- 依存関係のないタスクの順次実行
- Exploreエージェントを使わずに直接Grep/Globで広範な探索
- DODをスキップしたフェーズ完了
- ビルドエラーやテスト失敗を残したままのタスク完了

### 7. チェックリスト

フェーズ完了前に確認:
- [ ] 全ての並列可能なタスクを並列実行したか
- [ ] 適切なエージェントタイプを選択したか
- [ ] コードレビューを実施したか
- [ ] プロダクションビルドが成功したか
- [ ] 全てのテストが通過したか
- [ ] 型エラーがないか（TypeScriptの場合）

---

## 実践例

### 悪い例 ❌
```
1. ファイルを検索（Grep直接使用）
2. コードを実装
3. ビルド実行
4. テスト実行（順次）
```

### 良い例 ✅
```
1. 並列実行（1メッセージ）:
   - Exploreエージェント: ファイル構造分析
   - Exploreエージェント: 既存実装パターン調査

2. 並列実行（1メッセージ）:
   - general-purposeエージェント: 機能実装
   - general-purposeエージェント: テスト作成

3. DOD並列実行（1メッセージ）:
   - general-purposeエージェント: コードレビュー
   - Bash: ビルド + テスト + 型チェック
```

---

このルールに従うことで、Claude Codeのサブエージェント機能を最大限活用し、効率的で高品質な開発を実現します。
