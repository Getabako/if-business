<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Video Debug Test</title>
    <style>
        body {
            font-family: monospace;
            padding: 20px;
            background: #111;
            color: #fff;
        }
        .test-section {
            margin: 20px 0;
            padding: 20px;
            border: 1px solid #444;
            background: #222;
        }
        video {
            max-width: 300px;
            height: 200px;
            margin: 10px;
            border: 2px solid #666;
        }
        .error { color: #ff6666; }
        .success { color: #66ff66; }
        .info { color: #6666ff; }
    </style>
</head>
<body>
    <h1>Video Debug Test</h1>
    
    <div class="test-section">
        <h2>1. Direct Video Test</h2>
        <p>PC Version:</p>
        <video id="video-pc" controls>
            <source src="/videos/lpmoviepc.mp4" type="video/mp4">
        </video>
        <div id="pc-status"></div>
        
        <p>SP Version:</p>
        <video id="video-sp" controls>
            <source src="/videos/lpmoviesp.mp4" type="video/mp4">
        </video>
        <div id="sp-status"></div>
    </div>

    <div class="test-section">
        <h2>2. JavaScript Video Load Test</h2>
        <div id="js-test-results"></div>
    </div>

    <div class="test-section">
        <h2>3. Fetch API Test</h2>
        <div id="fetch-test-results"></div>
    </div>

    <div class="test-section">
        <h2>4. Environment Info</h2>
        <div id="env-info"></div>
    </div>

    <script>
        // Test 1: Video element events
        const videoPc = document.getElementById('video-pc');
        const videoSp = document.getElementById('video-sp');
        const pcStatus = document.getElementById('pc-status');
        const spStatus = document.getElementById('sp-status');

        videoPc.addEventListener('loadedmetadata', () => {
            pcStatus.innerHTML = '<span class="success">✓ PC video metadata loaded</span>';
        });
        videoPc.addEventListener('error', (e) => {
            pcStatus.innerHTML = `<span class="error">✗ PC video error: ${e.message || 'Unknown error'}</span>`;
        });

        videoSp.addEventListener('loadedmetadata', () => {
            spStatus.innerHTML = '<span class="success">✓ SP video metadata loaded</span>';
        });
        videoSp.addEventListener('error', (e) => {
            spStatus.innerHTML = `<span class="error">✗ SP video error: ${e.message || 'Unknown error'}</span>`;
        });

        // Test 2: JavaScript video creation
        const jsResults = document.getElementById('js-test-results');
        const testVideo = document.createElement('video');
        testVideo.src = '/videos/lpmoviepc.mp4';
        
        testVideo.addEventListener('canplay', () => {
            jsResults.innerHTML += '<div class="success">✓ JavaScript video creation successful</div>';
        });
        testVideo.addEventListener('error', () => {
            jsResults.innerHTML += '<div class="error">✗ JavaScript video creation failed</div>';
        });

        // Test 3: Fetch API
        const fetchResults = document.getElementById('fetch-test-results');
        
        async function testFetch() {
            try {
                fetchResults.innerHTML += '<div class="info">Testing PC video fetch...</div>';
                const pcResponse = await fetch('/videos/lpmoviepc.mp4', { method: 'HEAD' });
                fetchResults.innerHTML += `<div class="${pcResponse.ok ? 'success' : 'error'}">
                    PC video: ${pcResponse.status} ${pcResponse.statusText}
                    ${pcResponse.ok ? '✓' : '✗'}
                </div>`;
                
                fetchResults.innerHTML += '<div class="info">Testing SP video fetch...</div>';
                const spResponse = await fetch('/videos/lpmoviesp.mp4', { method: 'HEAD' });
                fetchResults.innerHTML += `<div class="${spResponse.ok ? 'success' : 'error'}">
                    SP video: ${spResponse.status} ${spResponse.statusText}
                    ${spResponse.ok ? '✓' : '✗'}
                </div>`;
                
                // Check headers
                if (pcResponse.ok) {
                    fetchResults.innerHTML += `<div class="info">
                        Content-Type: ${pcResponse.headers.get('content-type')}<br>
                        Content-Length: ${pcResponse.headers.get('content-length')} bytes
                    </div>`;
                }
            } catch (error) {
                fetchResults.innerHTML += `<div class="error">Fetch error: ${error.message}</div>`;
            }
        }
        
        testFetch();

        // Test 4: Environment info
        const envInfo = document.getElementById('env-info');
        envInfo.innerHTML = `
            <div>URL: ${window.location.href}</div>
            <div>Protocol: ${window.location.protocol}</div>
            <div>Host: ${window.location.host}</div>
            <div>User Agent: ${navigator.userAgent}</div>
        `;
    </script>
</body>
</html>