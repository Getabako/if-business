import { readFileSync, writeFileSync, existsSync, readdirSync, mkdirSync } from 'fs';
import { fileURLToPath } from 'url';
import { dirname, join } from 'path';
import { GoogleGenerativeAI } from '@google/generative-ai';
import dotenv from 'dotenv';

dotenv.config();

const __filename = fileURLToPath(import.meta.url);
const __dirname = dirname(__filename);

/**
 * CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ‘ãƒ¼ã‚¹
 */
function parseCSV(content) {
  const lines = content.trim().split('\n');
  if (lines.length < 2) return null;

  const headers = lines[0].split(',');
  const values = lines[1].split(',');

  const result = {};
  headers.forEach((header, i) => {
    result[header.trim()] = values[i] ? values[i].trim().replace(/^"|"$/g, '') : '';
  });

  return result;
}

/**
 * ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ãƒ•ã‚©ãƒ«ãƒ€ã®ã‚µãƒ–ãƒ•ã‚©ãƒ«ãƒ€(ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼)ã‚’ãƒªã‚¹ãƒˆã‚¢ãƒƒãƒ—
 */
function listCharacters() {
  const characterDir = join(__dirname, '..', 'character');
  if (!existsSync(characterDir)) return [];

  return readdirSync(characterDir, { withFileTypes: true })
    .filter(dirent => dirent.isDirectory())
    .map(dirent => dirent.name);
}

/**
 * imageruleãƒ•ã‚©ãƒ«ãƒ€ã®CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒªã‚¹ãƒˆã‚¢ãƒƒãƒ—
 */
function listImageRules() {
  const imageruleDir = join(__dirname, '..', 'imagerule');
  if (!existsSync(imageruleDir)) return [];

  return readdirSync(imageruleDir)
    .filter(file => file.endsWith('.csv'))
    .map(file => file.replace('.csv', ''));
}

/**
 * ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼è¨­å®šã‚’èª­ã¿è¾¼ã¿
 */
function loadCharacter(characterName) {
  // ã‚µãƒ–ãƒ•ã‚©ãƒ«ãƒ€å†…ã®CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ¢ã™
  const characterPath = join(__dirname, '..', 'character', characterName, `${characterName}.csv`);
  if (!existsSync(characterPath)) {
    throw new Error(`ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼è¨­å®šãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“: ${characterName}`);
  }

  const content = readFileSync(characterPath, 'utf-8');
  return parseCSV(content);
}

/**
 * ç”»åƒä¸€è²«æ€§ãƒ«ãƒ¼ãƒ«ã‚’èª­ã¿è¾¼ã¿
 */
function loadImageRule(ruleName) {
  const rulePath = join(__dirname, '..', 'imagerule', `${ruleName}.csv`);
  if (!existsSync(rulePath)) {
    throw new Error(`ä¸€è²«æ€§ãƒ«ãƒ¼ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“: ${ruleName}`);
  }

  const content = readFileSync(rulePath, 'utf-8');
  return parseCSV(content);
}

/**
 * å…¨ã¦ã®ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼è¨­å®šã‚’èª­ã¿è¾¼ã¿
 */
function loadAllCharacters() {
  const characterDir = join(__dirname, '..', 'character');
  if (!existsSync(characterDir)) return [];

  // ã‚µãƒ–ãƒ•ã‚©ãƒ«ãƒ€ã‚’ãƒªã‚¹ãƒˆã‚¢ãƒƒãƒ—
  const folders = readdirSync(characterDir, { withFileTypes: true })
    .filter(dirent => dirent.isDirectory())
    .map(dirent => dirent.name);

  const characters = [];

  for (const characterName of folders) {
    try {
      const character = loadCharacter(characterName);
      characters.push(character);
    } catch (error) {
      console.warn(`âš ï¸  ${characterName}ã®èª­ã¿è¾¼ã¿ã‚’ã‚¹ã‚­ãƒƒãƒ—:`, error.message);
    }
  }

  return characters;
}

/**
 * å…¨ã¦ã®ç”»åƒä¸€è²«æ€§ãƒ«ãƒ¼ãƒ«ã‚’èª­ã¿è¾¼ã¿
 */
function loadAllImageRules() {
  const imageruleDir = join(__dirname, '..', 'imagerule');
  if (!existsSync(imageruleDir)) return [];

  const files = readdirSync(imageruleDir).filter(file => file.endsWith('.csv'));
  const rules = [];

  for (const file of files) {
    const ruleName = file.replace('.csv', '');
    try {
      const rule = loadImageRule(ruleName);
      rules.push(rule);
    } catch (error) {
      console.warn(`âš ï¸  ${ruleName}ã®èª­ã¿è¾¼ã¿ã‚’ã‚¹ã‚­ãƒƒãƒ—:`, error.message);
    }
  }

  return rules;
}

/**
 * æ—¢å­˜ã®ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚’èª­ã¿è¾¼ã‚€
 */
function loadExistingCalendars() {
  const calendarDir = join(__dirname, '..', 'calendar');
  if (!existsSync(calendarDir)) {
    mkdirSync(calendarDir, { recursive: true });
    console.log('ğŸ“ calendarãƒ•ã‚©ãƒ«ãƒ€ã‚’ä½œæˆã—ã¾ã—ãŸ');
    return [];
  }

  const files = readdirSync(calendarDir)
    .filter(file => file.startsWith('calendar_') && file.endsWith('.csv'))
    .sort()
    .reverse(); // æœ€æ–°ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å…ˆã«

  const existingPosts = [];

  for (const file of files) {
    try {
      const filePath = join(calendarDir, file);
      const content = readFileSync(filePath, 'utf-8');
      const lines = content.split('\n').filter(line => line.trim());

      lines.forEach((line, index) => {
        const fields = parseCSVLine(line);
        if (fields.length >= 13) {
          existingPosts.push({
            file: file,
            day: index + 1,
            coverImage: fields[0],
            postText: fields[12]
          });
        }
      });
    } catch (error) {
      console.warn(`âš ï¸  ${file}ã®èª­ã¿è¾¼ã¿ã‚’ã‚¹ã‚­ãƒƒãƒ—:`, error.message);
    }
  }

  return existingPosts;
}

/**
 * AIã§æŠ•ç¨¿ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼(CSV)ã‚’ç”Ÿæˆ
 */
async function generateCalendar() {
  try {
    console.log('ğŸ“… if(Business) InstagramæŠ•ç¨¿ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚’ç”Ÿæˆä¸­...\n');

    // APIã‚­ãƒ¼ã®ç¢ºèª
    if (!process.env.GEMINI_API_KEY) {
      throw new Error('GEMINI_API_KEYãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚.envãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚');
    }

    // æŠ•ç¨¿æ•°ã®è¨­å®š(ç’°å¢ƒå¤‰æ•°ã‹ã‚‰å–å¾—ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯30æ—¥)
    const calendarDays = parseInt(process.env.CALENDAR_DAYS) || 30;
    console.log(`ğŸ“† ç”Ÿæˆã™ã‚‹æŠ•ç¨¿æ•°: ${calendarDays}æ—¥åˆ†\n`);

    // æ—¢å­˜ã®ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚’èª­ã¿è¾¼ã‚€
    const existingPosts = loadExistingCalendars();
    console.log(`ğŸ“š æ—¢å­˜ã®ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‹ã‚‰${existingPosts.length}ä»¶ã®æŠ•ç¨¿ã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ\n`);

    // äº‹æ¥­æƒ…å ±ã®èª­ã¿è¾¼ã¿
    const businessSummaryPath = join(__dirname, '..', 'output', 'business-summary.txt');
    if (!existsSync(businessSummaryPath)) {
      throw new Error('business-summary.txtãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚å…ˆã«analyze-homepage.jsã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚');
    }
    const businessSummary = readFileSync(businessSummaryPath, 'utf-8');

    // å…¨ã¦ã®ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼è¨­å®šã¨ä¸€è²«æ€§ãƒ«ãƒ¼ãƒ«ã®èª­ã¿è¾¼ã¿
    const characters = loadAllCharacters();
    const imageRules = loadAllImageRules();

    console.log('âœ… äº‹æ¥­æƒ…å ±ã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ');
    console.log(`âœ… ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼è¨­å®šã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ(${characters.length}äºº)`);
    console.log(`âœ… ä¸€è²«æ€§ãƒ«ãƒ¼ãƒ«ã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ(${imageRules.length}å€‹)\n`);

    if (characters.length === 0) {
      throw new Error('ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼è¨­å®šãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚characterãƒ•ã‚©ãƒ«ãƒ€ã«CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’é…ç½®ã—ã¦ãã ã•ã„ã€‚');
    }

    if (imageRules.length === 0) {
      throw new Error('ä¸€è²«æ€§ãƒ«ãƒ¼ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚imageruleãƒ•ã‚©ãƒ«ãƒ€ã«CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’é…ç½®ã—ã¦ãã ã•ã„ã€‚');
    }

    // ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼æƒ…å ±ã‚’è¡¨ç¤º
    console.log('ğŸ‘¥ èª­ã¿è¾¼ã‚“ã ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼:');
    characters.forEach(char => {
      console.log(`   - ${char.name}`);
    });

    console.log('\nğŸ¨ èª­ã¿è¾¼ã‚“ã ä¸€è²«æ€§ãƒ«ãƒ¼ãƒ«:');
    imageRules.forEach(rule => {
      console.log(`   - ${rule.setting_name || rule.name}`);
    });
    console.log();

    // Gemini APIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®åˆæœŸåŒ–
    const genAI = new GoogleGenerativeAI(process.env.GEMINI_API_KEY);
    const model = genAI.getGenerativeModel({ model: 'gemini-2.5-flash' });

    // ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼æƒ…å ±ã‚’ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç”¨ã«ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
    const charactersSection = characters.map((char, idx) => `
## ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼${idx + 1}: ${char.name}
- å¤–è¦‹: ${char.appearance}
- é«ª: ${char.hair}
- ç›®: ${char.eyes}
- é¡”: ${char.face}
- ä½“å‹: ${char.body}
- æœè£…: ${char.clothing}
- æ€§æ ¼: ${char.personality}
- è¿½åŠ æƒ…å ±: ${char.additional}
`).join('\n');

    // ç”»åƒãƒ«ãƒ¼ãƒ«æƒ…å ±ã‚’ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç”¨ã«ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
    const imageRulesSection = imageRules.map((rule, idx) => `
## ä¸€è²«æ€§ãƒ«ãƒ¼ãƒ«${idx + 1}: ${rule.setting_name || rule.name}
- å ´æ‰€ãƒ»ç’°å¢ƒ: ${rule.location_environment || rule.location}
- ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ãƒ»äººç‰©: ${rule.characters_people || rule.characters}
- æ™‚é–“å¸¯ãƒ»ç…§æ˜: ${rule.time_lighting || rule.lighting}
- é›°å›²æ°—ãƒ»ã‚¹ã‚¿ã‚¤ãƒ«: ${rule.atmosphere_style || rule.style}
- è¿½åŠ ã®è©³ç´°è¨­å®š: ${rule.additional_details || rule.additional}
`).join('\n');

    // æ—¢å­˜æŠ•ç¨¿æƒ…å ±ã‚’ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç”¨ã«ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
    let existingPostsSection = '';
    if (existingPosts.length > 0) {
      const recentPosts = existingPosts.slice(0, 50); // æœ€æ–°50ä»¶ã‚’å‚ç…§

      existingPostsSection = `
# æ—¢å­˜ã®æŠ•ç¨¿å±¥æ­´(${recentPosts.length}ä»¶) - é‡è¤‡å›é¿ã®ãŸã‚ã®é‡è¦ãªå‚è€ƒæƒ…å ±

**å¿…ãšä»¥ä¸‹ã‚’å®ˆã£ã¦ãã ã•ã„:**

1. **å®Œå…¨ã«æ–°ã—ã„ãƒ†ãƒ¼ãƒã‚’é¸ã¶**
   - æ—¢å­˜æŠ•ç¨¿ã¨åŒã˜ãƒ†ãƒ¼ãƒãƒ»åˆ‡ã‚Šå£ã¯é¿ã‘ã‚‹
   - æ—¢ã«ä½¿ã‚ã‚Œã¦ã„ã‚‹å…·ä½“ä¾‹ã‚„äº‹ä¾‹ã¯ä½¿ç”¨ã—ãªã„

2. **æ–°ã—ã„è¦–ç‚¹ã‚’æä¾›**
   - ç•°ãªã‚‹æŠ•ç¨¿ã‚¿ã‚¤ãƒ—ã‚’ãƒãƒ©ãƒ³ã‚¹ã‚ˆãé…åˆ†

3. **ãƒ†ãƒ¼ãƒã®å¤šæ§˜æ€§ã‚’ç¢ºä¿**
   - AIå°å…¥ã€ã‚·ã‚¹ãƒ†ãƒ é–‹ç™ºã€å®Œå…¨è‡ªå‹•åŒ–ãªã©å¤šæ§˜ãªãƒ†ãƒ¼ãƒã‚’æ‰±ã†

æœ€è¿‘ã®æŠ•ç¨¿ã‚µãƒ³ãƒ—ãƒ«(æœ€æ–°10ä»¶):
${recentPosts.slice(0, 10).map((post, idx) => `
### æ—¢å­˜æŠ•ç¨¿${idx + 1}(${post.file})
- æŠ•ç¨¿ãƒ†ã‚­ã‚¹ãƒˆ: ${post.postText.substring(0, 180)}...
`).join('\n')}

**ä»Šå›ç”Ÿæˆã™ã‚‹æŠ•ç¨¿ã¯ã€ä¸Šè¨˜ã®æ—¢å­˜æŠ•ç¨¿ã¨ã¯æ˜ç¢ºã«ç•°ãªã‚‹ã€å…¨ãæ–°ã—ã„å†…å®¹ã§ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ã€‚**
`;
    }

    // ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ç”Ÿæˆç”¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ
    const prompt = `
ã‚ãªãŸã¯Instagramãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°ã®å°‚é–€å®¶ã§ã™ã€‚ä»¥ä¸‹ã®æƒ…å ±ã‚’ã‚‚ã¨ã«ã€**if(Business)**ã®${calendarDays}æ—¥åˆ†ã®InstagramæŠ•ç¨¿ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼(ã‚«ãƒ«ãƒ¼ã‚»ãƒ«å½¢å¼)ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚

**é‡è¦: ã“ã®æŠ•ç¨¿ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã¯ã€Œif(Business)ã€ã¨ã„ã†æ³•äººãƒ»äº‹æ¥­è€…å‘ã‘ã®AIå°å…¥ãƒ»ã‚·ã‚¹ãƒ†ãƒ é–‹ç™ºã‚µãƒ¼ãƒ“ã‚¹ã®ãŸã‚ã®ã‚‚ã®ã§ã™ã€‚if(å¡¾)ã¨ã„ã†æ•™è‚²äº‹æ¥­ã¨ã¯å®Œå…¨ã«åˆ¥ã®ã‚µãƒ¼ãƒ“ã‚¹ã§ã™ã€‚çµ¶å¯¾ã«if(å¡¾)ã‚„å­ã©ã‚‚ãƒ»æ•™è‚²é–¢é€£ã®å†…å®¹ã‚’å«ã‚ãªã„ã§ãã ã•ã„ã€‚**

# if(Business)ã®äº‹æ¥­æƒ…å ±
${businessSummary}

# if(Business)ã®è¿½åŠ é‡è¦æƒ…å ±

## AIå°å…¥ã«ã‚ˆã‚‹å®Œå…¨è‡ªå‹•åŒ–ã‚µãƒ¼ãƒ“ã‚¹
if(Business)ã§ã¯ã€ä»¥ä¸‹ã®å®Œå…¨è‡ªå‹•åŒ–ã‚’å®Ÿç¾ã§ãã¾ã™:
- **SNSé‹ç”¨ã®å®Œå…¨è‡ªå‹•åŒ–**: Instagramã€X(Twitter)ã€Facebookç­‰ã®æŠ•ç¨¿ã‹ã‚‰åˆ†æã¾ã§å…¨è‡ªå‹•
- **å‹•ç”»åˆ¶ä½œã®å®Œå…¨è‡ªå‹•åŒ–**: YouTubeã‚·ãƒ§ãƒ¼ãƒˆã€ãƒªãƒ¼ãƒ«ã€TikTokç­‰ã®å‹•ç”»ã‚’è‡ªå‹•ç”Ÿæˆãƒ»æŠ•ç¨¿
- **ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°ã®å®Œå…¨è‡ªå‹•åŒ–**: ãƒ–ãƒ­ã‚°è¨˜äº‹ã€ãƒ¡ãƒ«ãƒã‚¬ã€ãƒ‹ãƒ¥ãƒ¼ã‚¹ãƒ¬ã‚¿ãƒ¼ã®è‡ªå‹•ä½œæˆãƒ»é…ä¿¡
- **ã‚«ã‚¹ã‚¿ãƒãƒ¼ã‚µãƒãƒ¼ãƒˆã®è‡ªå‹•åŒ–**: AIãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆã«ã‚ˆã‚‹24æ™‚é–“365æ—¥ã®é¡§å®¢å¯¾å¿œ
- **ãƒ‡ãƒ¼ã‚¿åˆ†æãƒ»ãƒ¬ãƒãƒ¼ãƒˆä½œæˆã®è‡ªå‹•åŒ–**: ãƒ“ã‚¸ãƒã‚¹ãƒ‡ãƒ¼ã‚¿ã®è‡ªå‹•é›†è¨ˆãƒ»å¯è¦–åŒ–ãƒ»ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ

## AIç ”ä¿®ãƒ»è¬›åº§ã‚µãƒ¼ãƒ“ã‚¹
- **ç¤¾å†…AIç ”ä¿®**: ç¤¾å“¡ã®AIæ´»ç”¨ã‚¹ã‚­ãƒ«ã‚’å‘ä¸Šã•ã›ã‚‹å®Ÿè·µçš„ãªç ”ä¿®ãƒ—ãƒ­ã‚°ãƒ©ãƒ 
- **AIå°å…¥ã‚³ãƒ³ã‚µãƒ«ãƒ†ã‚£ãƒ³ã‚°**: ä¼æ¥­ã«æœ€é©ãªAIå°å…¥æˆ¦ç•¥ã®è¨­è¨ˆãƒ»å®Ÿè¡Œæ”¯æ´
- **ã‚«ã‚¹ã‚¿ãƒ AIè¬›åº§**: æ¥­ç•Œãƒ»è·ç¨®åˆ¥ã«ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã•ã‚ŒãŸAIæ´»ç”¨è¬›åº§

## ã‚·ã‚¹ãƒ†ãƒ é–‹ç™ºã‚µãƒ¼ãƒ“ã‚¹
- **äº‹æ¥­ã«åˆã‚ã›ãŸã‚«ã‚¹ã‚¿ãƒ ã‚·ã‚¹ãƒ†ãƒ é–‹ç™º**: æ¥­å‹™ãƒ•ãƒ­ãƒ¼ã€æ¥­ç¨®ã€è¦æ¨¡ã«å®Œå…¨å¯¾å¿œã—ãŸã‚ªãƒ¼ãƒ€ãƒ¼ãƒ¡ã‚¤ãƒ‰é–‹ç™º
- **AIçµ±åˆã‚·ã‚¹ãƒ†ãƒ **: æ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ ã¸ã®AIæ©Ÿèƒ½è¿½åŠ ãƒ»çµ±åˆ
- **Webãƒ»ã‚¢ãƒ—ãƒªãƒ»ã‚²ãƒ¼ãƒ é–‹ç™º**: ãƒ“ã‚¸ãƒã‚¹ãƒ‹ãƒ¼ã‚ºã«å¿œã˜ãŸå„ç¨®ã‚·ã‚¹ãƒ†ãƒ æ§‹ç¯‰

## ãƒãƒ¼ãƒ ã®å¼·ã¿
- **å¡¾é•· å±±ï¨‘ç¢å·±**: AIã‚¢ãƒ³ãƒã‚µãƒ€ãƒ¼ã€èµ·æ¥­å®¶ã¨ã—ã¦5000äººè¶…ã®ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã§å®Ÿç¸¾ã€‚é«˜1ã§ITä¼šç¤¾èµ·æ¥­ã€AIé–‹ç™ºã‚„è¬›æ¼”ã‚‚è¡Œã†
- **CTO äº•ä¸Šé™½æ–—**: å¤©æ‰çš„ãªé–‹ç™ºåŠ›ã‚’æŒã¡ã€ç‹¬è‡ªAIãƒ»ã‚·ã‚¹ãƒ†ãƒ ã‚’æ¬¡ã€…ã¨å®Ÿè£…ã™ã‚‹æŠ€è¡“åŠ›(ãƒ‰ãƒ©ãˆã‚‚ã‚“ã®ã‚ˆã†ãªå­˜åœ¨)
- **å¡¾é ­ é«˜å´ç¿”å¤ª**: è‡¨åºŠå¿ƒç†å£«ã€ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã€ã‚³ãƒ³ã‚µãƒ«ã‚¿ãƒ³ãƒˆã¨ã—ã¦å¤šé¢çš„ã‚µãƒãƒ¼ãƒˆ

**ã“ã‚Œã‚‰ã®ãƒ¡ãƒ³ãƒãƒ¼ãŒã€if(Business)ã¨ã—ã¦æ³•äººãƒ»äº‹æ¥­è€…ã®æˆé•·ã¨åŠ¹ç‡åŒ–ã‚’å…¨åŠ›ã§ã‚µãƒãƒ¼ãƒˆã—ã¾ã™ã€‚**

${existingPostsSection}

# ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼è¨­å®š(ç™»å ´äººç‰©ã®ä¸€è²«æ€§)
ä»¥ä¸‹ã®${characters.length}äººã®ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ãŒåˆ©ç”¨å¯èƒ½ã§ã™ã€‚æŠ•ç¨¿å†…å®¹ã«å¿œã˜ã¦é©åˆ‡ãªã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã‚’é¸ã‚“ã§ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚è¤‡æ•°äººã‚’1ã¤ã®æŠ•ç¨¿ã«ç™»å ´ã•ã›ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã™ã€‚
${charactersSection}

# ç”»åƒä¸€è²«æ€§ãƒ«ãƒ¼ãƒ«
ä»¥ä¸‹ã®${imageRules.length}å€‹ã®ä¸€è²«æ€§ãƒ«ãƒ¼ãƒ«ãŒåˆ©ç”¨å¯èƒ½ã§ã™ã€‚æŠ•ç¨¿å†…å®¹ã«å¿œã˜ã¦é©åˆ‡ãªãƒ«ãƒ¼ãƒ«ã‚’é¸ã‚“ã§ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚
${imageRulesSection}

# ã‚«ãƒ«ãƒ¼ã‚»ãƒ«æŠ•ç¨¿ã®æ§‹æˆ
å„æ—¥ã®æŠ•ç¨¿ã¯4æšã®ç”»åƒã§æ§‹æˆã•ã‚Œã¾ã™:
1. è¡¨ç´™(ãƒ•ãƒƒã‚¯ã§æ³¨ç›®ã‚’é›†ã‚ã‚‹)
2. å†…å®¹1(å•é¡Œæèµ·ã¾ãŸã¯å…±æ„Ÿ)
3. å†…å®¹2(è§£æ±ºç­–ã¾ãŸã¯ä¾¡å€¤æç¤º)
4. å†…å®¹3(ã¾ã¨ã‚ãƒ»CTA)

# CSVãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ(13åˆ—)
Aåˆ—: è¡¨ç´™ç”»åƒèª¬æ˜(æ—¥æœ¬èª)
Båˆ—: è¡¨ç´™ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢1
Cåˆ—: è¡¨ç´™ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢2
Dåˆ—: å†…å®¹1ç”»åƒèª¬æ˜(æ—¥æœ¬èª)
Eåˆ—: å†…å®¹1ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢1
Fåˆ—: å†…å®¹1ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢2
Gåˆ—: å†…å®¹2ç”»åƒèª¬æ˜(æ—¥æœ¬èª)
Håˆ—: å†…å®¹2ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢1
Iåˆ—: å†…å®¹2ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢2
Jåˆ—: å†…å®¹3ç”»åƒèª¬æ˜(æ—¥æœ¬èª)
Kåˆ—: å†…å®¹3ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢1
Låˆ—: å†…å®¹3ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢2
Måˆ—: æŠ•ç¨¿ã®ãƒ†ã‚­ã‚¹ãƒˆ+ãƒãƒƒã‚·ãƒ¥ã‚¿ã‚°

## ç”»åƒèª¬æ˜(A,D,G,Jåˆ—)ã®ä½œæˆãƒ«ãƒ¼ãƒ«
- **å¿…ãšæ—¥æœ¬èªã§è¨˜è¿°**
- **é‡è¦: æ¶ç©ºã®ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã‚’ä½œæˆã—ãªã„ã§ãã ã•ã„ã€‚å¿…ãšä¸Šè¨˜ã®ã€Œã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼è¨­å®šã€ã‹ã‚‰é¸æŠã—ã¦ãã ã•ã„**
- ä¸Šè¨˜ã®ã€Œã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼è¨­å®šã€ã‹ã‚‰é©åˆ‡ãªã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã‚’é¸ã‚“ã§ç™»å ´ã•ã›ã‚‹(è¤‡æ•°äººã‚‚å¯)
- **ãƒ“ã‚¸ãƒã‚¹ã‚·ãƒ¼ãƒ³ã«å¿…è¦ãªäººç‰©ã®å ´åˆã¯ã€å¿…ãšã€Œå¡¾é ­é«˜å´ç¿”å¤ªã€ã€Œå¡¾é•·å±±ï¨‘ç¢å·±ã€ã€ŒCTOäº•ä¸Šé™½æ–—ã€ã®ã„ãšã‚Œã‹ã‚’ä½¿ç”¨ã—ã¦ãã ã•ã„**
- ä¸Šè¨˜ã®ã€Œç”»åƒä¸€è²«æ€§ãƒ«ãƒ¼ãƒ«ã€ã‹ã‚‰æŠ•ç¨¿å†…å®¹ã«é©ã—ãŸãƒ«ãƒ¼ãƒ«ã‚’é¸ã‚“ã§é©ç”¨
- äººç‰©ãŒç™»å ´ã™ã‚‹å ´åˆã¯ã€é¸ã‚“ã ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã®å¤–è¦‹ãƒ»æœè£…ãƒ»æ€§æ ¼ã‚’æ­£ç¢ºã«æå†™
- å ´æ‰€ãƒ»ç…§æ˜ãƒ»ã‚¹ã‚¿ã‚¤ãƒ«ã¯é¸ã‚“ã ä¸€è²«æ€§ãƒ«ãƒ¼ãƒ«ã«å¾“ã†
- å…·ä½“çš„ã§è©³ç´°ãªæå†™(AIãŒç”»åƒç”Ÿæˆã§ãã‚‹ãƒ¬ãƒ™ãƒ«ã®è©³ç´°ã•)
- å„ç”»åƒã¯ç•°ãªã‚‹æ§‹å›³ãƒ»ã‚¢ãƒ³ã‚°ãƒ«ã«ã™ã‚‹
- ${calendarDays}æ—¥åˆ†ã®æŠ•ç¨¿å…¨ä½“ã§ã€å…¨ã¦ã®ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã¨å…¨ã¦ã®ãƒ«ãƒ¼ãƒ«ãŒãƒãƒ©ãƒ³ã‚¹è‰¯ãç™»å ´ã™ã‚‹ã‚ˆã†ã«ã™ã‚‹

## ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢1(B,E,H,Kåˆ—)ã®ãƒ«ãƒ¼ãƒ«
- 1è¡Œã‚ãŸã‚Šæœ€å¤§8æ–‡å­—
- æœ€å¤§2è¡Œã¾ã§
- å˜èªã®é€”ä¸­ã§ã¯æ”¹è¡Œã—ãªã„
- æ”¹è¡Œã¯å˜èªã®åŒºåˆ‡ã‚Šç›®ã§è¡Œã†
- **æ”¹è¡Œã¯ã€Œ\\nã€ã§è¡¨ç¾ã™ã‚‹**(ä¾‹: "AIã¨\\nèµ·æ¥­")
- ã‚­ãƒ£ãƒƒãƒãƒ¼ã§çŸ­ã„ãƒ•ãƒ¬ãƒ¼ã‚º

## ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢2(C,F,I,Låˆ—)ã®ãƒ«ãƒ¼ãƒ«
- 1è¡Œã‚ãŸã‚Šæœ€å¤§12æ–‡å­—
- æœ€å¤§4è¡Œã¾ã§
- å˜èªã®é€”ä¸­ã§ã¯æ”¹è¡Œã—ãªã„
- æ”¹è¡Œã¯å˜èªã®åŒºåˆ‡ã‚Šç›®ã§è¡Œã†
- **æ”¹è¡Œã¯ã€Œ\\nã€ã§è¡¨ç¾ã™ã‚‹**(ä¾‹: "æ¥­å‹™åŠ¹ç‡åŒ–\\nã‚³ã‚¹ãƒˆå‰Šæ¸›\\nå£²ä¸ŠUP\\nã™ã¹ã¦å®Ÿç¾")
- ã‚ˆã‚Šè©³ç´°ãªèª¬æ˜

## æŠ•ç¨¿ãƒ†ã‚­ã‚¹ãƒˆ+ãƒãƒƒã‚·ãƒ¥ã‚¿ã‚°(Måˆ—)ã®ãƒ«ãƒ¼ãƒ«

### æŠ•ç¨¿æ–‡ã®æ§‹é€ (3æ®µæ§‹æˆ)
1. **ãƒ•ãƒƒã‚¯(1ã€œ2æ–‡)**: çµŒå–¶è€…ãƒ»äº‹æ¥­è€…ã®æ³¨æ„ã‚’å¼•ãã€å…±æ„Ÿã‚„é©šãã®è¦ç´ 
   - ä¾‹: ã€ŒSNSé‹ç”¨ã«æœˆ50æ™‚é–“ä½¿ã£ã¦ã„ã¾ã›ã‚“ã‹ï¼Ÿã€
   - ä¾‹: ã€ŒAIã§æ¥­å‹™æ™‚é–“ã‚’70%å‰Šæ¸›ã§ããŸã‚‰ã€ä½•ã‚’ã—ã¾ã™ã‹ï¼Ÿã€

2. **ä¾¡å€¤æç¤º(3ã€œ4æ–‡)**: å…·ä½“çš„ãªãƒ¡ãƒªãƒƒãƒˆã€è§£æ±ºç­–ã€å®Ÿç¸¾
   - âœ…ãƒãƒ¼ã‚¯ã‚„æ•°å­—ã‚’ä½¿ã£ã¦èª­ã¿ã‚„ã™ã
   - å…·ä½“çš„ãªå°å…¥äº‹ä¾‹ã‚„åŠ¹æœã‚’å«ã‚ã‚‹
   - ä¿¡é ¼æ„Ÿã‚’ä¸ãˆã‚‹æƒ…å ±(å®Ÿç¸¾ã€ã‚µãƒãƒ¼ãƒˆä½“åˆ¶ãªã©)

3. **CTA(1ã€œ2æ–‡)**: æ˜ç¢ºãªè¡Œå‹•å–šèµ·
   - ã€Œç„¡æ–™ç›¸è«‡å®Ÿæ–½ä¸­ã€ã€Œã¾ãšã¯ãŠæ°—è»½ã«ã”ç›¸è«‡ãã ã•ã„ã€
   - ã€Œãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã®ãƒªãƒ³ã‚¯ã¾ãŸã¯DMã¸ã€

### æŠ•ç¨¿æ–‡ã®è©³ç´°ãƒ«ãƒ¼ãƒ«
- æŠ•ç¨¿ãƒ†ã‚­ã‚¹ãƒˆã¯æ”¹è¡Œã‚’ä½¿ã‚ãšã€å¥èª­ç‚¹(ã€ã€‚)ã§åŒºåˆ‡ã‚‹
- 200ã€œ250æ–‡å­—ç¨‹åº¦ã®é­…åŠ›çš„ãªæ–‡ç« 
- çµŒå–¶è€…ãƒ»äº‹æ¥­è€…ç›®ç·šã§æ›¸ã(æ¥­å‹™åŠ¹ç‡åŒ–ã€ã‚³ã‚¹ãƒˆå‰Šæ¸›ã€å£²ä¸Šå‘ä¸Šã«ç„¦ç‚¹)
- å…·ä½“æ€§ã‚’é‡è¦–(ã€Œå¤šãã®ä¼æ¥­ã€ã‚ˆã‚Šã€Œè£½é€ æ¥­Aç¤¾ã€ã®ã‚ˆã†ã«)
- æŠ•ç¨¿ãƒ†ã‚­ã‚¹ãƒˆã®å¾Œã«ã‚¹ãƒšãƒ¼ã‚¹ã‚’å…¥ã‚Œã¦ãƒãƒƒã‚·ãƒ¥ã‚¿ã‚°ã‚’ç¶šã‘ã‚‹

### ãƒãƒƒã‚·ãƒ¥ã‚¿ã‚°æˆ¦ç•¥
**å¿…é ˆãƒãƒƒã‚·ãƒ¥ã‚¿ã‚°(æ¯å›å«ã‚ã‚‹)**: #ifBusiness #AIå°å…¥ #æ¥­å‹™åŠ¹ç‡åŒ–

**ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒƒã‚·ãƒ¥ã‚¿ã‚°(æŠ•ç¨¿å†…å®¹ã«å¿œã˜ã¦5ã€œ7å€‹é¸ã¶)**:
- ã‚µãƒ¼ãƒ“ã‚¹é–¢é€£: #ã‚·ã‚¹ãƒ†ãƒ é–‹ç™º #AIè‡ªå‹•åŒ– #SNSé‹ç”¨ä»£è¡Œ #å‹•ç”»åˆ¶ä½œ
- èª²é¡Œè§£æ±º: #ã‚³ã‚¹ãƒˆå‰Šæ¸› #ç”Ÿç”£æ€§å‘ä¸Š #DXæ¨é€² #åƒãæ–¹æ”¹é©
- ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ: #ä¸­å°ä¼æ¥­ #ã‚¹ã‚¿ãƒ¼ãƒˆã‚¢ãƒƒãƒ— #çµŒå–¶è€… #äº‹æ¥­è€…
- æŠ€è¡“: #AIç ”ä¿® #ChatGPT #ç”ŸæˆAI #ã‚«ã‚¹ã‚¿ãƒ AI
- æ¥­ç¨®: #è£½é€ æ¥­ #å°å£²æ¥­ #ã‚µãƒ¼ãƒ“ã‚¹æ¥­ #ECäº‹æ¥­

åˆè¨ˆ8ã€œ10å€‹ã®ãƒãƒƒã‚·ãƒ¥ã‚¿ã‚°ã‚’å«ã‚ã‚‹

## æŠ•ç¨¿ã‚¿ã‚¤ãƒ—ã¨æ§‹æˆæˆ¦ç•¥(${calendarDays}æ—¥åˆ†ã«å¤šæ§˜æ€§ã‚’)

### 1. èª²é¡Œå…±æ„Ÿå‹(20%)
- **ãƒ•ãƒƒã‚¯**: çµŒå–¶è€…ãƒ»äº‹æ¥­è€…ã®æ‚©ã¿ã«å…±æ„Ÿã™ã‚‹è¨€è‘‰
- **æœ¬æ–‡**: å…·ä½“çš„ãªè§£æ±ºäº‹ä¾‹ã€åŠ¹æœã®æç¤º
- **CTA**: ç„¡æ–™ç›¸è«‡ã¸ã®èª˜å°
- **ãƒ†ãƒ¼ãƒä¾‹**: ã€Œäººæ‰‹ä¸è¶³ã€ã€Œã‚³ã‚¹ãƒˆå¢—ã€ã€Œæ¥­å‹™éå¤šã€

### 2. æˆåŠŸäº‹ä¾‹å‹(20%)
- **ãƒ•ãƒƒã‚¯**: ã€Œã€‡ã€‡ç¤¾ãŒå£²ä¸Š2å€ã«ã€
- **æœ¬æ–‡**: å…·ä½“çš„ãªãƒ“ãƒ•ã‚©ãƒ¼ã‚¢ãƒ•ã‚¿ãƒ¼ã€å°å…¥åŠ¹æœ
- **CTA**: ã€Œã‚ãªãŸã®ä¼šç¤¾ã‚‚ã€ã¨ã„ã†å¸Œæœ›æç¤º
- **ãƒ†ãƒ¼ãƒä¾‹**: AIå°å…¥æˆåŠŸäº‹ä¾‹ã€è‡ªå‹•åŒ–ã«ã‚ˆã‚‹åŠ¹ç‡åŒ–ã€ã‚·ã‚¹ãƒ†ãƒ é–‹ç™ºã§ã®æˆæœ

### 3. æƒ…å ±æä¾›å‹(15%)
- **ãƒ•ãƒƒã‚¯**: ã€ŒçŸ¥ã£ã¦ã„ã¾ã—ãŸã‹?ã€ã€Œå®Ÿã¯ã€œã€
- **æœ¬æ–‡**: AIã€DXã€è‡ªå‹•åŒ–ã«é–¢ã™ã‚‹æœ‰ç›Šæƒ…å ±
- **CTA**: ã‚‚ã£ã¨è©³ã—ãçŸ¥ã‚ŠãŸã„æ–¹ã¯ç›¸è«‡ã¸
- **ãƒ†ãƒ¼ãƒä¾‹**: AIæ´»ç”¨Tipsã€æ¥­ç•Œãƒˆãƒ¬ãƒ³ãƒ‰ã€æœ€æ–°æŠ€è¡“æƒ…å ±

### 4. è‡ªå‹•åŒ–ã‚µãƒ¼ãƒ“ã‚¹ç´¹ä»‹å‹(20%)
- **ãƒ•ãƒƒã‚¯**: ã€ŒSNSé‹ç”¨ã‚’å®Œå…¨è‡ªå‹•åŒ–ã€
- **æœ¬æ–‡**: å…·ä½“çš„ãªè‡ªå‹•åŒ–å†…å®¹ã€å°å…¥ãƒ¡ãƒªãƒƒãƒˆ
- **CTA**: ç„¡æ–™ãƒ‡ãƒ¢ãƒ»ç›¸è«‡ã¸
- **ãƒ†ãƒ¼ãƒä¾‹**: SNSè‡ªå‹•åŒ–ã€å‹•ç”»è‡ªå‹•ç”Ÿæˆã€ãƒ¬ãƒãƒ¼ãƒˆè‡ªå‹•ä½œæˆ

### 5. è¬›å¸«ãƒ»ãƒãƒ¼ãƒ ç´¹ä»‹å‹(10%)
- **ãƒ•ãƒƒã‚¯**: ã€Œã“ã‚“ãªãƒãƒ¼ãƒ ãŒã‚µãƒãƒ¼ãƒˆã—ã¾ã™ã€
- **æœ¬æ–‡**: ãƒãƒ¼ãƒ ã®å°‚é–€æ€§ã€å®Ÿç¸¾
- **CTA**: ã“ã®ãƒãƒ¼ãƒ ã«ç›¸è«‡ã—ã¾ã›ã‚“ã‹
- **ãƒ†ãƒ¼ãƒä¾‹**: å±±ï¨‘å¡¾é•·ã€äº•ä¸ŠCTOã€é«˜å´å¡¾é ­ã®ç´¹ä»‹

### 6. Q&Aãƒ»ä¸å®‰è§£æ¶ˆå‹(10%)
- **ãƒ•ãƒƒã‚¯**: ã€Œã‚ˆãã‚ã‚‹è³ªå•ã€
- **æœ¬æ–‡**: å…·ä½“çš„ãªç–‘å•ã¸ã®å›ç­”
- **CTA**: ä»–ã«è³ªå•ãŒã‚ã‚Œã°DMã¸
- **ãƒ†ãƒ¼ãƒä¾‹**: æ–™é‡‘ã€å°å…¥æœŸé–“ã€ã‚µãƒãƒ¼ãƒˆä½“åˆ¶

### 7. å®Ÿç¸¾ãƒ»ä¿¡é ¼æ§‹ç¯‰å‹(5%)
- **ãƒ•ãƒƒã‚¯**: å…·ä½“çš„ãªæ•°å­—ã‚„å®Ÿç¸¾
- **æœ¬æ–‡**: å°å…¥ç¤¾æ•°ã€åŠ¹æœãƒ‡ãƒ¼ã‚¿
- **CTA**: å®Ÿç¸¾ã®ã‚ã‚‹ç§ãŸã¡ã«ãŠä»»ã›ãã ã•ã„
- **ãƒ†ãƒ¼ãƒä¾‹**: å°å…¥å®Ÿç¸¾ã€é¡§å®¢æº€è¶³åº¦ã€ç¶™ç¶šç‡

**é‡è¦**: ${calendarDays}æ—¥åˆ†ã®æŠ•ç¨¿ã§ã€ä¸Šè¨˜ã®æŠ•ç¨¿ã‚¿ã‚¤ãƒ—ã‚’ãƒãƒ©ãƒ³ã‚¹è‰¯ãé…åˆ†ã™ã‚‹ã“ã¨

## é‡è¦ãªåˆ¶ç´„
- **1æ—¥=1è¡Œ**(å¿…ãš13åˆ—ã‚’1è¡Œã«ã¾ã¨ã‚ã‚‹)
- **å„æ—¥ã®è¡Œã®æœ€å¾Œã«ã¯å¿…ãšæ”¹è¡Œã‚’å…¥ã‚Œã‚‹**(${calendarDays}æ—¥åˆ†=${calendarDays}è¡Œã«ã™ã‚‹)
- ãƒ˜ãƒƒãƒ€ãƒ¼ã¯ä¸è¦ã€ãƒ‡ãƒ¼ã‚¿è¡Œã®ã¿${calendarDays}è¡Œå‡ºåŠ›
- ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«ã‚«ãƒ³ãƒãŒå«ã¾ã‚Œã‚‹å ´åˆã¯ãƒ€ãƒ–ãƒ«ã‚¯ã‚©ãƒ¼ãƒˆã§å›²ã‚€
- **ç”»åƒèª¬æ˜ã¯å¿…ãšæ—¥æœ¬èª**
- **ãƒ†ã‚­ã‚¹ãƒˆå†…ã®æ”¹è¡Œã¯å¿…ãšã€Œ\\nã€ã§è¡¨ç¾**
- **å…¨ã¦ã®ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼è¨­å®šã¨å…¨ã¦ã®ä¸€è²«æ€§ãƒ«ãƒ¼ãƒ«ã‚’æ´»ç”¨ã™ã‚‹ã“ã¨**
- **${calendarDays}æ—¥åˆ†ã§ã€å…¨ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã¨å…¨ãƒ«ãƒ¼ãƒ«ãŒãƒãƒ©ãƒ³ã‚¹è‰¯ãç™»å ´ã™ã‚‹ã‚ˆã†ã«é…åˆ†ã™ã‚‹**
- **æ¶ç©ºã®ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã¯çµ¶å¯¾ã«ä½œæˆã—ãªã„ã“ã¨ã€‚å¿…ãšä¸Šè¨˜ã®ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼è¨­å®šãƒªã‚¹ãƒˆã‹ã‚‰é¸æŠã™ã‚‹ã“ã¨**
- **çµ¶å¯¾ã«if(å¡¾)ã‚„æ•™è‚²ãƒ»å­ã©ã‚‚é–¢é€£ã®å†…å®¹ã‚’å«ã‚ãªã„ã“ã¨ã€‚if(Business)ã¯æ³•äººãƒ»äº‹æ¥­è€…å‘ã‘ã‚µãƒ¼ãƒ“ã‚¹ã§ã™**
- **èª‡å¼µè¡¨ç¾ã‚’é¿ã‘ã‚‹ã“ã¨**: ã€Œæœ€å¼·ã€ã€Œå®Œç’§ã€ã€Œçµ¶å¯¾ã€ãªã©ã®éåº¦ãªè¡¨ç¾ã¯ä½¿ç”¨ã—ãªã„ã€‚ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ã§ä¿¡é ¼ã§ãã‚‹ãƒˆãƒ¼ãƒ³ã‚’ä¿ã¤

## å‡ºåŠ›ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
ä»¥ä¸‹ã®ã‚ˆã†ã«ã€**å¿…ãšå„æ—¥ã®è¡Œã®å¾Œã«æ”¹è¡Œã‚’å…¥ã‚Œã¦ã€${calendarDays}è¡Œã§å‡ºåŠ›ã—ã¦ãã ã•ã„**:

1æ—¥ç›®ã®13åˆ—ãƒ‡ãƒ¼ã‚¿
2æ—¥ç›®ã®13åˆ—ãƒ‡ãƒ¼ã‚¿
3æ—¥ç›®ã®13åˆ—ãƒ‡ãƒ¼ã‚¿
${calendarDays > 3 ? '...ï¼ˆä¸­ç•¥ï¼‰...\n' + calendarDays + 'æ—¥ç›®ã®13åˆ—ãƒ‡ãƒ¼ã‚¿' : ''}

## å‡ºåŠ›ä¾‹(3æ—¥åˆ†)

ã€æŠ•ç¨¿1: èª²é¡Œå…±æ„Ÿå‹ã€‘
"ãƒ¢ãƒ€ãƒ³ãªã‚ªãƒ•ã‚£ã‚¹ã§ã€å¡¾é•·å±±ï¨‘ç¢å·±ãŒçµŒå–¶è€…ã‚‰ã—ã„æœè£…ã§ã€è¤‡æ•°ã®ãƒ¢ãƒ‹ã‚¿ãƒ¼ã®å‰ã«ç«‹ã¡ã€SNSé‹ç”¨ã®åˆ†æç”»é¢ã‚’è¦‹ã¤ã‚ã¦ã„ã‚‹ã€‚è¡¨æƒ…ã¯çœŸå‰£ã§ã€æ¥­å‹™ã®å¤šã•ã«æ‚©ã‚“ã§ã„ã‚‹æ§˜å­ã€‚å‘¨ã‚Šã«ã¯æœªå‡¦ç†ã®ã‚¿ã‚¹ã‚¯ãƒªã‚¹ãƒˆã€‚ä¸€è²«æ€§ãƒ«ãƒ¼ãƒ«1é©ç”¨ã€‚","SNSé‹ç”¨\\nã«ç–²å¼Š","æœˆ50æ™‚é–“ã‚’\\nå¥ªã‚ã‚Œã‚‹\\nSNSé‹ç”¨\\nã‚‚ã†é™ç•Œã§ã¯ï¼Ÿ","æ˜ã‚‹ã„ã‚ªãƒ•ã‚£ã‚¹ã§ã€CTOäº•ä¸Šé™½æ–—ãŒãƒãƒ¼ãƒˆPCã‚’é–‹ãã€AIè‡ªå‹•åŒ–ã‚·ã‚¹ãƒ†ãƒ ã®ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‚’è¦‹ã›ã¦ã„ã‚‹ã€‚ç”»é¢ã«ã¯Instagramã€Xã€Facebookã®è‡ªå‹•æŠ•ç¨¿ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ã€‚åŠ¹ç‡çš„ãªé›°å›²æ°—ã€‚ä¸€è²«æ€§ãƒ«ãƒ¼ãƒ«1é©ç”¨ã€‚","å®Œå…¨\\nè‡ªå‹•åŒ–","AI ãŒ24æ™‚é–“\\nè‡ªå‹•ã§æŠ•ç¨¿\\nåˆ†æã¾ã§\\nå…¨éƒ¨ãŠä»»ã›","ã‚ªãƒ•ã‚£ã‚¹ã§ã€å¡¾é ­é«˜å´ç¿”å¤ªãŒå°å…¥ä¼æ¥­ã®æ‹…å½“è€…ã¨ç¬‘é¡”ã§æ¡æ‰‹ã—ã¦ã„ã‚‹ã€‚ãƒ¢ãƒ‹ã‚¿ãƒ¼ã«ã¯ã€Œé‹ç”¨æ™‚é–“70%å‰Šæ¸›ã€ã€Œã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆ150%UPã€ã¨ã„ã†ã‚°ãƒ©ãƒ•ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ã€‚æˆåŠŸã‚’ç¥ã†é›°å›²æ°—ã€‚ä¸€è²«æ€§ãƒ«ãƒ¼ãƒ«1é©ç”¨ã€‚","å°å…¥ä¼æ¥­\\nã®å£°","æ™‚é–“ã‚‚\\nã‚³ã‚¹ãƒˆã‚‚\\nå¤§å¹…å‰Šæ¸›\\nåŠ¹æœã¯2å€ã«","å¡¾é•·å±±ï¨‘ç¢å·±ã€CTOäº•ä¸Šé™½æ–—ã€å¡¾é ­é«˜å´ç¿”å¤ªã®3äººãŒä¸¦ã‚“ã§ç«‹ã¡ã€è‡ªä¿¡ã«æº€ã¡ãŸè¡¨æƒ…ã€‚èƒŒæ™¯ã«ã¯if(Business)ã®ãƒ­ã‚´ã¨ã€ŒSNSå®Œå…¨è‡ªå‹•åŒ–ã€ã®æ–‡å­—ã€‚ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ãªé›°å›²æ°—ã€‚ä¸€è²«æ€§ãƒ«ãƒ¼ãƒ«1é©ç”¨ã€‚","if(Business)\\nã«ãŠä»»ã›","ç„¡æ–™ãƒ‡ãƒ¢ã§\\nãã®åŠ¹æœã‚’\\nä»Šã™ã\\nä½“é¨“","SNSé‹ç”¨ã«æœˆ50æ™‚é–“ä½¿ã£ã¦ã„ã¾ã›ã‚“ã‹ï¼Ÿif(Business)ã®AIå®Œå…¨è‡ªå‹•åŒ–ãªã‚‰ã€âœ…æŠ•ç¨¿ãƒ»ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚ºã‚’è‡ªå‹•ç”Ÿæˆ âœ…æœ€é©ãªæ™‚é–“ã«è‡ªå‹•æŠ•ç¨¿ âœ…ãƒ‡ãƒ¼ã‚¿åˆ†æãƒ»ãƒ¬ãƒãƒ¼ãƒˆã‚‚è‡ªå‹•ã€ã™ã¹ã¦ãŠä»»ã›ã§ãã¾ã™ã€‚è£½é€ æ¥­Aç¤¾ã¯é‹ç”¨æ™‚é–“70%å‰Šæ¸›ã€ã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆ150%UPã‚’å®Ÿç¾ã—ã¾ã—ãŸã€‚ã‚ãªãŸã®æ™‚é–“ã‚’æœ¬æ¥­ã«é›†ä¸­ã•ã›ã¾ã›ã‚“ã‹ï¼Ÿç„¡æ–™ãƒ‡ãƒ¢å®Ÿæ–½ä¸­ã€‚ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã®ãƒªãƒ³ã‚¯ã¾ãŸã¯DMã¸ã€‚ #ifBusiness #AIå°å…¥ #æ¥­å‹™åŠ¹ç‡åŒ– #SNSé‹ç”¨ä»£è¡Œ #ã‚³ã‚¹ãƒˆå‰Šæ¸› #ç”Ÿç”£æ€§å‘ä¸Š #ä¸­å°ä¼æ¥­ #DXæ¨é€²"

ã€æŠ•ç¨¿2: æˆåŠŸäº‹ä¾‹å‹ã€‘
"ãƒ¢ãƒ€ãƒ³ãªä¼šè­°å®¤ã§ã€å¡¾é ­é«˜å´ç¿”å¤ªãŒå°å£²æ¥­ã®çµŒå–¶è€…ã«å¯¾ã—ã¦ãƒ—ãƒ¬ã‚¼ãƒ³ã—ã¦ã„ã‚‹ã€‚å¤§å‹ãƒ¢ãƒ‹ã‚¿ãƒ¼ã«ã¯åœ¨åº«ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã®æ”¹å–„ã‚°ãƒ©ãƒ•ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ã€‚çµŒå–¶è€…ã¯èˆˆå‘³æ·±ãã†ã«èã„ã¦ã„ã‚‹ã€‚ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ãªé›°å›²æ°—ã€‚ä¸€è²«æ€§ãƒ«ãƒ¼ãƒ«1é©ç”¨ã€‚","åœ¨åº«ç®¡ç†\\nã®æ‚©ã¿","éå‰°åœ¨åº«ã¨\\næ¬ å“ã®ç¹°ã‚Šè¿”ã—\\nå£²ä¸Šæ©Ÿä¼šã‚’\\né€ƒã—ã¦ã„ãŸ","ã‚ªãƒ•ã‚£ã‚¹ã§ã€CTOäº•ä¸Šé™½æ–—ãŒãƒãƒ¼ãƒˆPCã§AIéœ€è¦äºˆæ¸¬ã‚·ã‚¹ãƒ†ãƒ ã®ãƒ‡ãƒ¢ã‚’è¦‹ã›ã¦ã„ã‚‹ã€‚ç”»é¢ã«ã¯å•†å“åˆ¥ã®éœ€è¦äºˆæ¸¬ã‚°ãƒ©ãƒ•ã¨è‡ªå‹•ç™ºæ³¨ã®ä»•çµ„ã¿ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ã€‚æŠ€è¡“åŠ›ã®é«˜ã•ãŒä¼ã‚ã‚‹ã€‚ä¸€è²«æ€§ãƒ«ãƒ¼ãƒ«1é©ç”¨ã€‚","AIäºˆæ¸¬\\nã‚·ã‚¹ãƒ†ãƒ ","éå»ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰\\næœ€é©åœ¨åº«ã‚’\\nè‡ªå‹•ç®—å‡º\\nç™ºæ³¨ã¾ã§å®Œå…¨è‡ªå‹•","æ˜ã‚‹ã„ã‚ªãƒ•ã‚£ã‚¹ã§ã€å°å£²æ¥­Bç¤¾ã®æ‹…å½“è€…ãŒæº€è¶³ãã†ã«çµæœãƒ¬ãƒãƒ¼ãƒˆã‚’è¦‹ã¦ã„ã‚‹ã€‚ç”»é¢ã«ã¯ã€Œåœ¨åº«å›è»¢ç‡40%UPã€ã€Œæ¬ å“ç‡5%ä»¥ä¸‹ã€ã€Œå¹´é–“1500ä¸‡å††å‰Šæ¸›ã€ã¨ã„ã†æˆæœãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ã€‚æˆåŠŸã®å–œã³ã€‚ä¸€è²«æ€§ãƒ«ãƒ¼ãƒ«1é©ç”¨ã€‚","é©šãã®\\næˆæœ","åœ¨åº«ã‚³ã‚¹ãƒˆ\\nå¤§å¹…å‰Šæ¸›\\næ¬ å“ã‚‚ã»ã¼ã‚¼ãƒ­\\nã«æ”¹å–„","å¡¾é•·å±±ï¨‘ç¢å·±ã€CTOäº•ä¸Šé™½æ–—ã€å¡¾é ­é«˜å´ç¿”å¤ªã®3äººãŒã‚ªãƒ•ã‚£ã‚¹ã§è‡ªä¿¡ã«æº€ã¡ãŸè¡¨æƒ…ã§ç«‹ã£ã¦ã„ã‚‹ã€‚èƒŒæ™¯ã«ã¯æˆåŠŸäº‹ä¾‹ã®æ•°ã€…ã€‚ã€Œæ¬¡ã¯ã‚ãªãŸã®ç•ªã§ã™ã€ã¨ã„ã†ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã€‚ä¸€è²«æ€§ãƒ«ãƒ¼ãƒ«1é©ç”¨ã€‚","ã‚ãªãŸã®\\nä¼šç¤¾ã‚‚","if(Business)ãŒ\\nå…¨åŠ›ã§\\nã‚µãƒãƒ¼ãƒˆ\\nã—ã¾ã™","å°å£²æ¥­Bç¤¾æ§˜ã€AIå°å…¥ã§å¤§æˆåŠŸã€‚åœ¨åº«ç®¡ç†ãŒå±äººåŒ–ã—ã€éå‰°åœ¨åº«ã¨æ¬ å“ãŒé »ç™ºã—ã¦ã„ã¾ã—ãŸã€‚if(Business)ã®AIéœ€è¦äºˆæ¸¬ã‚·ã‚¹ãƒ†ãƒ ã‚’å°å…¥ã—ãŸçµæœã€âœ…åœ¨åº«å›è»¢ç‡40%å‘ä¸Š âœ…æ¬ å“ç‡5%ä»¥ä¸‹ã«å‰Šæ¸› âœ…å¹´é–“1500ä¸‡å††ã®ã‚³ã‚¹ãƒˆå‰Šæ¸›ã‚’å®Ÿç¾ã€‚éå»ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰æœ€é©åœ¨åº«ã‚’è‡ªå‹•ç®—å‡ºã—ã€ç™ºæ³¨ã¾ã§å®Œå…¨è‡ªå‹•åŒ–ã€‚ã‚ãªãŸã®ä¼šç¤¾ã®åœ¨åº«å•é¡Œã‚‚è§£æ±ºã§ãã¾ã™ã€‚ç„¡æ–™ç›¸è«‡å®Ÿæ–½ä¸­ã€‚ #ifBusiness #AIå°å…¥ #æ¥­å‹™åŠ¹ç‡åŒ– #åœ¨åº«ç®¡ç† #å°å£²æ¥­ #ã‚³ã‚¹ãƒˆå‰Šæ¸› #AIè‡ªå‹•åŒ– #DXæ¨é€²"

ã€æŠ•ç¨¿3: è‡ªå‹•åŒ–ã‚µãƒ¼ãƒ“ã‚¹ç´¹ä»‹å‹ã€‘
"ãƒ¢ãƒ€ãƒ³ãªã‚ªãƒ•ã‚£ã‚¹ã§ã€CTOäº•ä¸Šé™½æ–—ãŒPCã®å‰ã«åº§ã‚Šã€å‹•ç”»ç·¨é›†ã‚½ãƒ•ãƒˆã¨AIè‡ªå‹•ç”Ÿæˆã‚·ã‚¹ãƒ†ãƒ ã®ç”»é¢ã‚’ä¸¦ã¹ã¦è¡¨ç¤ºã—ã¦ã„ã‚‹ã€‚ç”»é¢ã«ã¯YouTubeã‚·ãƒ§ãƒ¼ãƒˆã€ãƒªãƒ¼ãƒ«ã€TikTokã®å‹•ç”»ãŒè‡ªå‹•ç”Ÿæˆã•ã‚Œã¦ã„ã‚‹æ§˜å­ã€‚é©æ–°çš„ãªé›°å›²æ°—ã€‚ä¸€è²«æ€§ãƒ«ãƒ¼ãƒ«1é©ç”¨ã€‚","å‹•ç”»åˆ¶ä½œ\\nã®æ‚©ã¿","æ¯æ—¥ã®å‹•ç”»ä½œæˆ\\nã«è¿½ã‚ã‚Œã¦\\næœ¬æ¥­ãŒ\\nãŠã‚ãã‹ã«","æ˜ã‚‹ã„ã‚¹ã‚¿ã‚¸ã‚ªã§ã€å¡¾é•·å±±ï¨‘ç¢å·±ãŒã‚«ãƒ¡ãƒ©ã®å‰ã§è©±ã—ã¦ã„ã‚‹æ§˜å­ã‚’AIãŒè‡ªå‹•ã§ç·¨é›†ã—ã¦ã„ã‚‹ç”»é¢ã€‚å­—å¹•ã€BGMã€ã‚¨ãƒ•ã‚§ã‚¯ãƒˆãŒè‡ªå‹•ã§è¿½åŠ ã•ã‚Œã¦ã„ãæ§˜å­ãŒè¦‹ãˆã‚‹ã€‚åŠ¹ç‡çš„ã§æœªæ¥çš„ã€‚ä¸€è²«æ€§ãƒ«ãƒ¼ãƒ«1é©ç”¨ã€‚","å®Œå…¨\\nè‡ªå‹•åŒ–","AIãŒ\\næ’®å½±ã‹ã‚‰\\nç·¨é›†ãƒ»æŠ•ç¨¿ã¾ã§\\nå…¨è‡ªå‹•","ã‚ªãƒ•ã‚£ã‚¹ã§ã€å¡¾é ­é«˜å´ç¿”å¤ªãŒå°å…¥ä¼æ¥­ã®æ‹…å½“è€…ã«æˆæœãƒ¬ãƒãƒ¼ãƒˆã‚’è¦‹ã›ã¦ã„ã‚‹ã€‚ãƒ¢ãƒ‹ã‚¿ãƒ¼ã«ã¯ã€Œå‹•ç”»åˆ¶ä½œæ™‚é–“90%å‰Šæ¸›ã€ã€ŒæŠ•ç¨¿é »åº¦5å€ã€ã€Œè¦–è´å›æ•°3å€ã€ã¨ã„ã†ã‚°ãƒ©ãƒ•ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ã€‚æˆåŠŸã®è¨¼ã€‚ä¸€è²«æ€§ãƒ«ãƒ¼ãƒ«1é©ç”¨ã€‚","é©šç•°çš„\\nåŠ¹ç‡åŒ–","åˆ¶ä½œæ™‚é–“\\n1/10ã§\\næŠ•ç¨¿é »åº¦ã¯\\n5å€ã«","3äººã®ãƒ¡ãƒ³ãƒãƒ¼ãŒä¸¦ã‚“ã§ç«‹ã¡ã€èƒŒæ™¯ã«ã¯ã€Œå‹•ç”»å®Œå…¨è‡ªå‹•åŒ–ã€ã®æ–‡å­—ã¨if(Business)ã®ãƒ­ã‚´ã€‚è‡ªä¿¡ã¨ä¿¡é ¼æ„Ÿã«æº€ã¡ãŸè¡¨æƒ…ã€‚ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ãªé›°å›²æ°—ã€‚ä¸€è²«æ€§ãƒ«ãƒ¼ãƒ«1é©ç”¨ã€‚","if(Business)\\nã®å‹•ç”»AI","ã‚ãªãŸã®\\nã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’\\nè‡ªå‹•ã§\\né‡ç”£","å‹•ç”»åˆ¶ä½œã«è¿½ã‚ã‚Œã¦ã„ã¾ã›ã‚“ã‹ï¼Ÿif(Business)ã®å‹•ç”»AIå®Œå…¨è‡ªå‹•åŒ–ãªã‚‰ã€âœ…å°æœ¬è‡ªå‹•ç”Ÿæˆ âœ…éŸ³å£°ãƒ»å­—å¹•è‡ªå‹•è¿½åŠ  âœ…æœ€é©ãªå½¢å¼ã«è‡ªå‹•å¤‰æ› âœ…YouTubeã‚·ãƒ§ãƒ¼ãƒˆã€ãƒªãƒ¼ãƒ«ã€TikTokã«è‡ªå‹•æŠ•ç¨¿ã€ã™ã¹ã¦è‡ªå‹•ã§ã™ã€‚ECäº‹æ¥­Cç¤¾ã¯åˆ¶ä½œæ™‚é–“90%å‰Šæ¸›ã€æŠ•ç¨¿é »åº¦5å€ã€è¦–è´å›æ•°3å€ã‚’é”æˆã—ã¾ã—ãŸã€‚ã‚ãªãŸã‚‚å‹•ç”»ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°ã‚’åŠ é€Ÿã•ã›ã¾ã›ã‚“ã‹ï¼Ÿç„¡æ–™ãƒ‡ãƒ¢å®Ÿæ–½ä¸­ã€‚ #ifBusiness #AIå°å…¥ #æ¥­å‹™åŠ¹ç‡åŒ– #å‹•ç”»åˆ¶ä½œ #å‹•ç”»ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚° #ã‚³ãƒ³ãƒ†ãƒ³ãƒ„è‡ªå‹•åŒ– #YouTubeã‚·ãƒ§ãƒ¼ãƒˆ #ãƒªãƒ¼ãƒ«"

**ä¸Šè¨˜ã®ã‚ˆã†ã«ã€å¿…ãš${calendarDays}æ—¥åˆ†ã€${calendarDays}è¡Œã®CSVã‚’å‡ºåŠ›ã—ã¦ãã ã•ã„ã€‚å„è¡Œã®æœ€å¾Œã«ã¯æ”¹è¡Œã‚’å…¥ã‚Œã¦ãã ã•ã„ã€‚**
`;

    console.log('ğŸ¤– Gemini AIã§ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚’ç”Ÿæˆä¸­...');
    console.log('â³ å‡¦ç†ã«ã¯1ã€œ2åˆ†ã‹ã‹ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™\n');

    const result = await model.generateContent(prompt);
    const response = await result.response;
    let calendarCSV = response.text().trim();

    // ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯ã®ãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³ã‚’å‰Šé™¤
    calendarCSV = calendarCSV.replace(/```csv\n/g, '').replace(/```\n/g, '').replace(/```/g, '');

    // ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ã‚’ç”Ÿæˆ
    const now = new Date();
    const timestamp = now.toISOString().replace(/T/, '_').replace(/:/g, '-').split('.')[0];

    // calendarãƒ•ã‚©ãƒ«ãƒ€ã«ä¿å­˜
    const calendarDir = join(__dirname, '..', 'calendar');
    if (!existsSync(calendarDir)) {
      mkdirSync(calendarDir, { recursive: true });
      console.log('ğŸ“ calendarãƒ•ã‚©ãƒ«ãƒ€ã‚’ä½œæˆã—ã¾ã—ãŸ');
    }
    const calendarPath = join(calendarDir, `calendar_${timestamp}.csv`);
    writeFileSync(calendarPath, calendarCSV, 'utf-8');

    // ä¿å­˜ç¢ºèª
    if (existsSync(calendarPath)) {
      console.log(`âœ… ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼å±¥æ­´ã«ä¿å­˜ã—ã¾ã—ãŸ: ${calendarPath}`);
    } else {
      console.warn(`âš ï¸  è­¦å‘Š: ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼å±¥æ­´ã¸ã®ä¿å­˜ã«å¤±æ•—ã—ãŸå¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™`);
    }

    // outputãƒ•ã‚©ãƒ«ãƒ€ã«ã‚‚ä¿å­˜(å¾Œæ–¹äº’æ›æ€§ã®ãŸã‚)
    const csvPath = join(__dirname, '..', 'output', 'calendar.csv');
    writeFileSync(csvPath, calendarCSV, 'utf-8');

    console.log('âœ… ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼CSVã‚’ç”Ÿæˆã—ã¾ã—ãŸ');
    console.log(`ğŸ’¾ ä¿å­˜å…ˆ(ãƒ¡ã‚¤ãƒ³): ${calendarPath}`);
    console.log(`ğŸ’¾ ä¿å­˜å…ˆ(ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—): ${csvPath}\n`);

    // CSVã‚’ãƒ‘ãƒ¼ã‚¹ã—ã¦æ¤œè¨¼
    const lines = calendarCSV.split('\n').filter(line => line.trim());
    console.log(`ğŸ“Š ç”Ÿæˆã•ã‚ŒãŸæŠ•ç¨¿æ•°: ${lines.length}æ—¥åˆ†\n`);

    // ã‚µãƒ³ãƒ—ãƒ«ã‚’è¡¨ç¤º
    if (lines.length > 0) {
      console.log('ğŸ“ æœ€åˆã®æŠ•ç¨¿ã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼:');
      const firstLine = parseCSVLine(lines[0]);
      console.log(`  åˆ—æ•°: ${firstLine.length}åˆ—`);
      console.log('  è¡¨ç´™ç”»åƒ: ', firstLine[0]?.substring(0, 60) + '...');
      console.log('  è¡¨ç´™ãƒ†ã‚­ã‚¹ãƒˆ1: ', firstLine[1]);
      console.log('  è¡¨ç´™ãƒ†ã‚­ã‚¹ãƒˆ2: ', firstLine[2]);
      console.log('  æŠ•ç¨¿ãƒ†ã‚­ã‚¹ãƒˆ: ', firstLine[12]?.substring(0, 80) + '...');
    }

    return csvPath;
  } catch (error) {
    console.error('âŒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ:', error.message);
    process.exit(1);
  }
}

/**
 * CSVè¡Œã‚’ãƒ‘ãƒ¼ã‚¹(ã‚¯ã‚©ãƒ¼ãƒˆå¯¾å¿œ)
 */
function parseCSVLine(line) {
  const result = [];
  let current = '';
  let inQuotes = false;

  for (let i = 0; i < line.length; i++) {
    const char = line[i];
    const nextChar = line[i + 1];

    if (char === '"') {
      if (inQuotes && nextChar === '"') {
        current += '"';
        i++;
      } else {
        inQuotes = !inQuotes;
      }
    } else if (char === ',' && !inQuotes) {
      result.push(current);
      current = '';
    } else {
      current += char;
    }
  }

  result.push(current);
  return result;
}

// ãƒ¡ã‚¤ãƒ³å‡¦ç†
generateCalendar();
